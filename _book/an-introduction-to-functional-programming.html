<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 An Introduction to Functional Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach</title>
  <meta name="description" content="Chapter 15 An Introduction to Functional Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 An Introduction to Functional Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/pics/cover.png" />
  
  <meta name="github-repo" content="tbrown122387/r_and_python_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 An Introduction to Functional Programming | An Introduction to R and Python For Data Analysis: A Side By Side Approach" />
  
  
  <meta name="twitter:image" content="/pics/cover.png" />

<meta name="author" content="Taylor R. Brown" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="an-introduction-to-object-oriented-programming.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">An Introduction to R and Python For Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#teaching-a-course-with-this-textbook"><i class="fa fa-check"></i>Teaching a Course With This Textbook</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licenses"><i class="fa fa-check"></i>License(s)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-this-book"><i class="fa fa-check"></i>About this book</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-the-required-software"><i class="fa fa-check"></i>Installing the Required Software</a><ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-r-and-rstudio"><i class="fa fa-check"></i>Installing R (and RStudio)</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#installing-python-by-installing-anaconda"><i class="fa fa-check"></i>Installing Python by Installing Anaconda</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Introducing the Basics</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#hello-world-in-r"><i class="fa fa-check"></i><b>1.1</b> Hello World in R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#hello-world-in-python"><i class="fa fa-check"></i><b>1.2</b> Hello World in Python</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>1.3</b> Getting Help</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#reading-documentation"><i class="fa fa-check"></i><b>1.3.1</b> Reading Documentation</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#understanding-file-paths"><i class="fa fa-check"></i><b>1.3.2</b> Understanding File Paths</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-types.html"><a href="basic-types.html"><i class="fa fa-check"></i><b>2</b> Basic Types</a><ul>
<li class="chapter" data-level="2.1" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-python"><i class="fa fa-check"></i><b>2.1</b> Basic Types In Python</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-python"><i class="fa fa-check"></i><b>2.1.1</b> Type Conversions in Python</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basic-types.html"><a href="basic-types.html#basic-types-in-r"><i class="fa fa-check"></i><b>2.2</b> Basic Types In R</a><ul>
<li class="chapter" data-level="2.2.1" data-path="basic-types.html"><a href="basic-types.html#type-conversions-in-r"><i class="fa fa-check"></i><b>2.2.1</b> Type Conversions in R</a></li>
<li class="chapter" data-level="2.2.2" data-path="basic-types.html"><a href="basic-types.html#rs-simplification"><i class="fa fa-check"></i><b>2.2.2</b> R’s Simplification</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="basic-types.html"><a href="basic-types.html#exercises"><i class="fa fa-check"></i><b>2.3</b> Exercises</a><ul>
<li class="chapter" data-level="2.3.1" data-path="basic-types.html"><a href="basic-types.html#r-questions"><i class="fa fa-check"></i><b>2.3.1</b> R Questions</a></li>
<li class="chapter" data-level="2.3.2" data-path="basic-types.html"><a href="basic-types.html#python-questions"><i class="fa fa-check"></i><b>2.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html"><i class="fa fa-check"></i><b>3</b> R <code>vector</code>s versus Numpy <code>array</code>s and Pandas’ <code>Series</code></a><ul>
<li class="chapter" data-level="3.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-r"><i class="fa fa-check"></i><b>3.1</b> Overview of R</a></li>
<li class="chapter" data-level="3.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#overview-of-python"><i class="fa fa-check"></i><b>3.2</b> Overview of Python</a></li>
<li class="chapter" data-level="3.3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-r"><i class="fa fa-check"></i><b>3.3</b> Vectorization in R</a></li>
<li class="chapter" data-level="3.4" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-python"><i class="fa fa-check"></i><b>3.4</b> Vectorization in Python</a></li>
<li class="chapter" data-level="3.5" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-vectors-in-r"><i class="fa fa-check"></i><b>3.5</b> Indexing Vectors in R</a></li>
<li class="chapter" data-level="3.6" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-numpy-arrays"><i class="fa fa-check"></i><b>3.6</b> Indexing Numpy arrays</a></li>
<li class="chapter" data-level="3.7" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#indexing-pandas-series"><i class="fa fa-check"></i><b>3.7</b> Indexing Pandas’ Series</a></li>
<li class="chapter" data-level="3.8" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#some-gotchas"><i class="fa fa-check"></i><b>3.8</b> Some Gotchas</a><ul>
<li class="chapter" data-level="3.8.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#shallow-versus-deep-copies"><i class="fa fa-check"></i><b>3.8.1</b> Shallow versus Deep Copies</a></li>
<li class="chapter" data-level="3.8.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#how-r-and-python-handle-missing-values"><i class="fa fa-check"></i><b>3.8.2</b> How R and Python Handle Missing Values</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#an-introduction-to-regular-expressions"><i class="fa fa-check"></i><b>3.9</b> An Introduction to Regular Expressions</a><ul>
<li class="chapter" data-level="3.9.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#literal-characters-versus-metacharacters"><i class="fa fa-check"></i><b>3.9.1</b> Literal Characters versus Metacharacters</a></li>
<li class="chapter" data-level="3.9.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#the-trouble-with-backslashes-escape-sequences"><i class="fa fa-check"></i><b>3.9.2</b> The Trouble With Backslashes: Escape Sequences</a></li>
<li class="chapter" data-level="3.9.3" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#more-examples-of-using-regular-expressions"><i class="fa fa-check"></i><b>3.9.3</b> More Examples of Using Regular Expressions</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#exercises-1"><i class="fa fa-check"></i><b>3.10</b> Exercises</a><ul>
<li class="chapter" data-level="3.10.1" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#r-questions-1"><i class="fa fa-check"></i><b>3.10.1</b> R Questions</a></li>
<li class="chapter" data-level="3.10.2" data-path="r-vectors-versus-numpy-arrays-and-pandas-series.html"><a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#python-questions-1"><i class="fa fa-check"></i><b>3.10.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><i class="fa fa-check"></i><b>4</b> Numpy <code>ndarray</code>s Versus R’s <code>matrix</code> and <code>array</code> Types</a><ul>
<li class="chapter" data-level="4.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#numpy-ndarrays-in-python"><i class="fa fa-check"></i><b>4.1</b> Numpy <code>ndarray</code>s In Python</a></li>
<li class="chapter" data-level="4.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#the-matrix-and-array-classes-in-r"><i class="fa fa-check"></i><b>4.2</b> The <code>matrix</code> and <code>array</code> classes in R</a></li>
<li class="chapter" data-level="4.3" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a><ul>
<li class="chapter" data-level="4.3.1" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#r-questions-2"><i class="fa fa-check"></i><b>4.3.1</b> R Questions</a></li>
<li class="chapter" data-level="4.3.2" data-path="numpy-ndarrays-versus-rs-matrix-and-array-types.html"><a href="numpy-ndarrays-versus-rs-matrix-and-array-types.html#python-questions-2"><i class="fa fa-check"></i><b>4.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html"><i class="fa fa-check"></i><b>5</b> R’s <code>list</code>s Versus Python’s <code>list</code>s and <code>dict</code>s</a><ul>
<li class="chapter" data-level="5.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-r"><i class="fa fa-check"></i><b>5.1</b> <code>list</code>s In R</a></li>
<li class="chapter" data-level="5.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#lists-in-python"><i class="fa fa-check"></i><b>5.2</b> <code>list</code>s In Python</a></li>
<li class="chapter" data-level="5.3" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#dictionaries-in-python"><i class="fa fa-check"></i><b>5.3</b> Dictionaries In Python</a></li>
<li class="chapter" data-level="5.4" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#exercises-3"><i class="fa fa-check"></i><b>5.4</b> Exercises</a><ul>
<li class="chapter" data-level="5.4.1" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#r-questions-3"><i class="fa fa-check"></i><b>5.4.1</b> R Questions</a></li>
<li class="chapter" data-level="5.4.2" data-path="rs-lists-versus-pythons-lists-and-dicts.html"><a href="rs-lists-versus-pythons-lists-and-dicts.html#python-questions-3"><i class="fa fa-check"></i><b>5.4.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>6</b> Functions</a><ul>
<li class="chapter" data-level="6.1" data-path="functions.html"><a href="functions.html#defining-r-functions"><i class="fa fa-check"></i><b>6.1</b> Defining R Functions</a></li>
<li class="chapter" data-level="6.2" data-path="functions.html"><a href="functions.html#defining-python-functions"><i class="fa fa-check"></i><b>6.2</b> Defining Python Functions</a></li>
<li class="chapter" data-level="6.3" data-path="functions.html"><a href="functions.html#more-details-on-rs-user-defined-functions"><i class="fa fa-check"></i><b>6.3</b> More Details On R’s User-Defined Functions</a></li>
<li class="chapter" data-level="6.4" data-path="functions.html"><a href="functions.html#more-details-on-pythons-user-defined-functions"><i class="fa fa-check"></i><b>6.4</b> More details on Python’s user-defined functions</a></li>
<li class="chapter" data-level="6.5" data-path="functions.html"><a href="functions.html#function-scope-in-r"><i class="fa fa-check"></i><b>6.5</b> Function Scope in R</a></li>
<li class="chapter" data-level="6.6" data-path="functions.html"><a href="functions.html#function-scope-in-python"><i class="fa fa-check"></i><b>6.6</b> Function Scope in Python</a></li>
<li class="chapter" data-level="6.7" data-path="functions.html"><a href="functions.html#modifying-a-functions-arguments"><i class="fa fa-check"></i><b>6.7</b> Modifying a Function’s Arguments</a><ul>
<li class="chapter" data-level="6.7.1" data-path="functions.html"><a href="functions.html#passing-by-value-in-r"><i class="fa fa-check"></i><b>6.7.1</b> Passing By Value In R</a></li>
<li class="chapter" data-level="6.7.2" data-path="functions.html"><a href="functions.html#passing-by-assignment-in-python"><i class="fa fa-check"></i><b>6.7.2</b> Passing By Assignment In Python</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="functions.html"><a href="functions.html#accessing-and-modifying-captured-variables"><i class="fa fa-check"></i><b>6.8</b> Accessing and Modifying Captured Variables</a><ul>
<li class="chapter" data-level="6.8.1" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-r"><i class="fa fa-check"></i><b>6.8.1</b> Accessing Captured Variables in R</a></li>
<li class="chapter" data-level="6.8.2" data-path="functions.html"><a href="functions.html#accessing-captured-variables-in-python"><i class="fa fa-check"></i><b>6.8.2</b> Accessing Captured Variables in Python</a></li>
<li class="chapter" data-level="6.8.3" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-r"><i class="fa fa-check"></i><b>6.8.3</b> Modifying Captured Variables In R</a></li>
<li class="chapter" data-level="6.8.4" data-path="functions.html"><a href="functions.html#modifying-captured-variables-in-python"><i class="fa fa-check"></i><b>6.8.4</b> Modifying Captured Variables In Python</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="functions.html"><a href="functions.html#exercises-4"><i class="fa fa-check"></i><b>6.9</b> Exercises</a><ul>
<li class="chapter" data-level="6.9.1" data-path="functions.html"><a href="functions.html#r-questions-4"><i class="fa fa-check"></i><b>6.9.1</b> R Questions</a></li>
<li class="chapter" data-level="6.9.2" data-path="functions.html"><a href="functions.html#python-questions-4"><i class="fa fa-check"></i><b>6.9.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>7</b> Categorical Data</a><ul>
<li class="chapter" data-level="7.1" data-path="categorical-data.html"><a href="categorical-data.html#factors-in-r"><i class="fa fa-check"></i><b>7.1</b> <code>factor</code>s in R</a></li>
<li class="chapter" data-level="7.2" data-path="categorical-data.html"><a href="categorical-data.html#two-options-for-categorical-data-in-pandas"><i class="fa fa-check"></i><b>7.2</b> Two Options for Categorical Data in Pandas</a></li>
<li class="chapter" data-level="7.3" data-path="categorical-data.html"><a href="categorical-data.html#exercises-5"><i class="fa fa-check"></i><b>7.3</b> Exercises</a><ul>
<li class="chapter" data-level="7.3.1" data-path="categorical-data.html"><a href="categorical-data.html#r-questions-5"><i class="fa fa-check"></i><b>7.3.1</b> R Questions</a></li>
<li class="chapter" data-level="7.3.2" data-path="categorical-data.html"><a href="categorical-data.html#python-questions-5"><i class="fa fa-check"></i><b>7.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-frames.html"><a href="data-frames.html"><i class="fa fa-check"></i><b>8</b> Data Frames</a><ul>
<li class="chapter" data-level="8.1" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-r"><i class="fa fa-check"></i><b>8.1</b> Data Frames in R</a></li>
<li class="chapter" data-level="8.2" data-path="data-frames.html"><a href="data-frames.html#data-frames-in-python"><i class="fa fa-check"></i><b>8.2</b> Data Frames in Python</a></li>
<li class="chapter" data-level="8.3" data-path="data-frames.html"><a href="data-frames.html#exercises-6"><i class="fa fa-check"></i><b>8.3</b> Exercises</a><ul>
<li class="chapter" data-level="8.3.1" data-path="data-frames.html"><a href="data-frames.html#r-questions-6"><i class="fa fa-check"></i><b>8.3.1</b> R Questions</a></li>
<li class="chapter" data-level="8.3.2" data-path="data-frames.html"><a href="data-frames.html#python-questions-6"><i class="fa fa-check"></i><b>8.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Common Tasks and Patterns</b></span></li>
<li class="chapter" data-level="9" data-path="input-and-output.html"><a href="input-and-output.html"><i class="fa fa-check"></i><b>9</b> Input and Output</a><ul>
<li class="chapter" data-level="9.1" data-path="input-and-output.html"><a href="input-and-output.html#general-input-considerations"><i class="fa fa-check"></i><b>9.1</b> General Input Considerations</a></li>
<li class="chapter" data-level="9.2" data-path="input-and-output.html"><a href="input-and-output.html#reading-in-text-files-with-r"><i class="fa fa-check"></i><b>9.2</b> Reading in Text Files with R</a></li>
<li class="chapter" data-level="9.3" data-path="input-and-output.html"><a href="input-and-output.html#reading-in-text-files-with-pandas"><i class="fa fa-check"></i><b>9.3</b> Reading in Text Files with Pandas</a></li>
<li class="chapter" data-level="9.4" data-path="input-and-output.html"><a href="input-and-output.html#saving-data-in-r"><i class="fa fa-check"></i><b>9.4</b> Saving Data in R</a><ul>
<li class="chapter" data-level="9.4.1" data-path="input-and-output.html"><a href="input-and-output.html#writing-out-tabular-plain-text-data-in-r"><i class="fa fa-check"></i><b>9.4.1</b> Writing Out Tabular Plain Text Data in R</a></li>
<li class="chapter" data-level="9.4.2" data-path="input-and-output.html"><a href="input-and-output.html#serialization-in-r"><i class="fa fa-check"></i><b>9.4.2</b> Serialization in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="input-and-output.html"><a href="input-and-output.html#saving-data-in-python"><i class="fa fa-check"></i><b>9.5</b> Saving Data in Python</a><ul>
<li class="chapter" data-level="9.5.1" data-path="input-and-output.html"><a href="input-and-output.html#writing-out-tabular-plain-text-data-in-python"><i class="fa fa-check"></i><b>9.5.1</b> Writing Out Tabular Plain Text Data in Python</a></li>
<li class="chapter" data-level="9.5.2" data-path="input-and-output.html"><a href="input-and-output.html#serialization-in-python"><i class="fa fa-check"></i><b>9.5.2</b> Serialization in Python</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="input-and-output.html"><a href="input-and-output.html#exercises-7"><i class="fa fa-check"></i><b>9.6</b> Exercises</a><ul>
<li class="chapter" data-level="9.6.1" data-path="input-and-output.html"><a href="input-and-output.html#r-questions-7"><i class="fa fa-check"></i><b>9.6.1</b> R Questions</a></li>
<li class="chapter" data-level="9.6.2" data-path="input-and-output.html"><a href="input-and-output.html#python-questions-7"><i class="fa fa-check"></i><b>9.6.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-third-party-code.html"><a href="using-third-party-code.html"><i class="fa fa-check"></i><b>10</b> Using Third-Party Code</a><ul>
<li class="chapter" data-level="10.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-r"><i class="fa fa-check"></i><b>10.1</b> Installing Packages In R</a></li>
<li class="chapter" data-level="10.2" data-path="using-third-party-code.html"><a href="using-third-party-code.html#installing-packages-in-python"><i class="fa fa-check"></i><b>10.2</b> Installing Packages In Python</a></li>
<li class="chapter" data-level="10.3" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-r"><i class="fa fa-check"></i><b>10.3</b> Loading Packages In R</a></li>
<li class="chapter" data-level="10.4" data-path="using-third-party-code.html"><a href="using-third-party-code.html#loading-packages-in-python"><i class="fa fa-check"></i><b>10.4</b> Loading Packages In Python</a><ul>
<li class="chapter" data-level="10.4.1" data-path="using-third-party-code.html"><a href="using-third-party-code.html#importing-examples"><i class="fa fa-check"></i><b>10.4.1</b> <code>import</code>ing Examples</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="using-third-party-code.html"><a href="using-third-party-code.html#exercises-8"><i class="fa fa-check"></i><b>10.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>11</b> Control Flow</a><ul>
<li class="chapter" data-level="11.1" data-path="control-flow.html"><a href="control-flow.html#conditional-logic"><i class="fa fa-check"></i><b>11.1</b> Conditional Logic</a></li>
<li class="chapter" data-level="11.2" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>11.2</b> Loops</a></li>
<li class="chapter" data-level="11.3" data-path="control-flow.html"><a href="control-flow.html#exercises-9"><i class="fa fa-check"></i><b>11.3</b> Exercises</a><ul>
<li class="chapter" data-level="11.3.1" data-path="control-flow.html"><a href="control-flow.html#r-questions-8"><i class="fa fa-check"></i><b>11.3.1</b> R Questions</a></li>
<li class="chapter" data-level="11.3.2" data-path="control-flow.html"><a href="control-flow.html#python-questions-8"><i class="fa fa-check"></i><b>11.3.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html"><i class="fa fa-check"></i><b>12</b> Reshaping and Combining Data Sets</a><ul>
<li class="chapter" data-level="12.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#ordering-and-sorting-data"><i class="fa fa-check"></i><b>12.1</b> Ordering and Sorting Data</a></li>
<li class="chapter" data-level="12.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#stacking-data-sets-and-placing-them-shoulder-to-shoulder"><i class="fa fa-check"></i><b>12.2</b> Stacking Data Sets and Placing Them Shoulder to Shoulder</a></li>
<li class="chapter" data-level="12.3" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#merging-or-joining-data-sets"><i class="fa fa-check"></i><b>12.3</b> Merging or Joining Data Sets</a></li>
<li class="chapter" data-level="12.4" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-data"><i class="fa fa-check"></i><b>12.4</b> Long Versus Wide Data</a><ul>
<li class="chapter" data-level="12.4.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-r"><i class="fa fa-check"></i><b>12.4.1</b> Long Versus Wide in R</a></li>
<li class="chapter" data-level="12.4.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#long-versus-wide-in-python"><i class="fa fa-check"></i><b>12.4.2</b> Long Versus Wide in Python</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#exercises-10"><i class="fa fa-check"></i><b>12.5</b> Exercises</a><ul>
<li class="chapter" data-level="12.5.1" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#r-questions-9"><i class="fa fa-check"></i><b>12.5.1</b> R Questions</a></li>
<li class="chapter" data-level="12.5.2" data-path="reshaping-and-combining-data-sets.html"><a href="reshaping-and-combining-data-sets.html#python-questions-9"><i class="fa fa-check"></i><b>12.5.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>13</b> Visualization</a><ul>
<li class="chapter" data-level="13.1" data-path="visualization.html"><a href="visualization.html#base-r-plotting"><i class="fa fa-check"></i><b>13.1</b> Base R Plotting</a></li>
<li class="chapter" data-level="13.2" data-path="visualization.html"><a href="visualization.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>13.2</b> Plotting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="13.3" data-path="visualization.html"><a href="visualization.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>13.3</b> Plotting with Matplotlib</a></li>
<li class="chapter" data-level="13.4" data-path="visualization.html"><a href="visualization.html#plotting-with-pandas"><i class="fa fa-check"></i><b>13.4</b> Plotting with Pandas</a></li>
<li class="chapter" data-level="13.5" data-path="visualization.html"><a href="visualization.html#exercises-11"><i class="fa fa-check"></i><b>13.5</b> Exercises</a><ul>
<li class="chapter" data-level="13.5.1" data-path="visualization.html"><a href="visualization.html#r-questions-10"><i class="fa fa-check"></i><b>13.5.1</b> R Questions</a></li>
<li class="chapter" data-level="13.5.2" data-path="visualization.html"><a href="visualization.html#python-questions-10"><i class="fa fa-check"></i><b>13.5.2</b> Python Questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Programming Styles</b></span></li>
<li class="chapter" data-level="14" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html"><i class="fa fa-check"></i><b>14</b> An Introduction to Object-Oriented Programming</a><ul>
<li class="chapter" data-level="14.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#oop-in-python"><i class="fa fa-check"></i><b>14.1</b> OOP In Python</a><ul>
<li class="chapter" data-level="14.1.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#overview"><i class="fa fa-check"></i><b>14.1.1</b> Overview</a></li>
<li class="chapter" data-level="14.1.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#a-first-example"><i class="fa fa-check"></i><b>14.1.2</b> A First Example</a></li>
<li class="chapter" data-level="14.1.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#adding-inheritance"><i class="fa fa-check"></i><b>14.1.3</b> Adding Inheritance</a></li>
<li class="chapter" data-level="14.1.4" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#adding-in-composition"><i class="fa fa-check"></i><b>14.1.4</b> Adding in Composition</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#oop-in-r"><i class="fa fa-check"></i><b>14.2</b> OOP In R</a><ul>
<li class="chapter" data-level="14.2.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#s3-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.1</b> S3 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#using-s3-objects"><i class="fa fa-check"></i><b>14.2.2</b> Using S3 objects</a></li>
<li class="chapter" data-level="14.2.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-s3-objects"><i class="fa fa-check"></i><b>14.2.3</b> Creating S3 objects</a></li>
<li class="chapter" data-level="14.2.4" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#s4-objects-the-big-picture"><i class="fa fa-check"></i><b>14.2.4</b> S4 objects: The Big Picture</a></li>
<li class="chapter" data-level="14.2.5" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#using-s4-objects"><i class="fa fa-check"></i><b>14.2.5</b> Using S4 objects</a></li>
<li class="chapter" data-level="14.2.6" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-s4-objects"><i class="fa fa-check"></i><b>14.2.6</b> Creating S4 objects</a></li>
<li class="chapter" data-level="14.2.7" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#reference-classes-the-big-picture"><i class="fa fa-check"></i><b>14.2.7</b> Reference Classes: The Big Picture</a></li>
<li class="chapter" data-level="14.2.8" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-reference-classes"><i class="fa fa-check"></i><b>14.2.8</b> Creating Reference Classes</a></li>
<li class="chapter" data-level="14.2.9" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#creating-r6-classes"><i class="fa fa-check"></i><b>14.2.9</b> Creating R6 Classes</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#exercises-12"><i class="fa fa-check"></i><b>14.3</b> Exercises</a><ul>
<li class="chapter" data-level="14.3.1" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#python-questions-11"><i class="fa fa-check"></i><b>14.3.1</b> Python Questions</a></li>
<li class="chapter" data-level="14.3.2" data-path="an-introduction-to-object-oriented-programming.html"><a href="an-introduction-to-object-oriented-programming.html#r-questions-11"><i class="fa fa-check"></i><b>14.3.2</b> R Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html"><i class="fa fa-check"></i><b>15</b> An Introduction to Functional Programming</a><ul>
<li class="chapter" data-level="15.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-r"><i class="fa fa-check"></i><b>15.1</b> Functions as Function Inputs in R</a><ul>
<li class="chapter" data-level="15.1.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#sapply-and-vapply"><i class="fa fa-check"></i><b>15.1.1</b> <code>sapply()</code> and <code>vapply()</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#lapply"><i class="fa fa-check"></i><b>15.1.2</b> <code>lapply()</code></a></li>
<li class="chapter" data-level="15.1.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#apply"><i class="fa fa-check"></i><b>15.1.3</b> <code>apply()</code></a></li>
<li class="chapter" data-level="15.1.4" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#tapply"><i class="fa fa-check"></i><b>15.1.4</b> <code>tapply()</code></a></li>
<li class="chapter" data-level="15.1.5" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#mapply"><i class="fa fa-check"></i><b>15.1.5</b> <code>mapply()</code></a></li>
<li class="chapter" data-level="15.1.6" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#reduce-and-do.call"><i class="fa fa-check"></i><b>15.1.6</b> <code>Reduce()</code> and <code>do.call()</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-python"><i class="fa fa-check"></i><b>15.2</b> Functions as Function Inputs in Python</a><ul>
<li class="chapter" data-level="15.2.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-base-python"><i class="fa fa-check"></i><b>15.2.1</b> Functions as Function Inputs in Base Python</a></li>
<li class="chapter" data-level="15.2.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-numpy"><i class="fa fa-check"></i><b>15.2.2</b> Functions as Function Inputs in Numpy</a></li>
<li class="chapter" data-level="15.2.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functional-methods-in-pandas"><i class="fa fa-check"></i><b>15.2.3</b> Functional Methods in Pandas</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-r"><i class="fa fa-check"></i><b>15.3</b> Functions as Function Outputs in R</a></li>
<li class="chapter" data-level="15.4" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-python"><i class="fa fa-check"></i><b>15.4</b> Functions as Function Outputs in Python</a><ul>
<li class="chapter" data-level="15.4.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#writing-our-own-decorators"><i class="fa fa-check"></i><b>15.4.1</b> Writing Our Own Decorators</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#exercises-13"><i class="fa fa-check"></i><b>15.5</b> Exercises</a><ul>
<li class="chapter" data-level="15.5.1" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#python-questions-12"><i class="fa fa-check"></i><b>15.5.1</b> Python Questions</a></li>
<li class="chapter" data-level="15.5.2" data-path="an-introduction-to-functional-programming.html"><a href="an-introduction-to-functional-programming.html#r-questions-12"><i class="fa fa-check"></i><b>15.5.2</b> R Questions</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to R and Python For Data Analysis: A Side By Side Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="an-introduction-to-functional-programming" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 15</span> An Introduction to Functional Programming<a href="an-introduction-to-functional-programming.html#an-introduction-to-functional-programming" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Functional Programming (FP)</strong> is another way of thinking about how to organize programs. We talked about OOP—another way to organize programs—in the last chapter (chapter <a href="an-introduction-to-object-oriented-programming.html#an-introduction-to-object-oriented-programming">14</a>). So how do OOP and FP differ? To put it simply, FP focuses on functions instead of objects. Because we are talking a lot about functions in this chapter, we will assume you have read and understood section <a href="functions.html#functions">6</a>.</p>
<p>Neither R nor Python is a purely functional language. For us, FP is a style that we can choose to let guide us, or that we can disregard. You can choose to employ a more functional style, or you can choose to use a more object-oriented style, or neither. Some people tend to prefer one style to other styles, and others prefer to decide which to use depending on the task at hand.</p>
<p>More specifically, a functional programming style takes advantage of <strong>first-class functions</strong> and favors functions that are <strong>pure</strong>.</p>
<ol style="list-style-type: decimal">
<li><strong>First-class functions</strong> are <span class="citation">(Abelson and Sussman <a href="#ref-struc_and_interp">1996</a>)</span> functions that
<ul>
<li>can be passed as arguments to other functions,</li>
<li>can be returned from other functions, and</li>
<li>can be assigned to variables or stored in data structures.</li>
</ul></li>
<li><strong>Pure functions</strong>
<ul>
<li>return the same output if they are given the same input, and</li>
<li>do not produce <strong>side-effects</strong>.</li>
</ul></li>
</ol>
<p>Side-effects are changes made to non-temporary variables, to the “state” of the program.</p>
<p>We discussed (1) in the beginning of chapter <a href="functions.html#functions">6</a>. If you have not used any other programming languages before, you might even take (1) for granted. However, using first-class functions can be difficult in other languages not mentioned in this text.</p>
<p>There is more to say about definition (2). This means you should keep your functions as <em>modular</em> as possible, unless you want your overall program to be much more difficult to understand. FP stipulates that</p>
<ul>
<li><p><strong>ideally functions will not refer to non-local variables;</strong></p></li>
<li><p><strong>ideally functions will not (refer to and) modify non-local variables; and</strong></p></li>
<li><p><strong>ideally functions will not modify their arguments.</strong></p></li>
</ul>
<p>Unfortunately, violating the first of these three criteria is very easy to do in both of our languages. Recall our conversation about <em>dynamic lookup</em> in subsection <a href="functions.html#accessing-and-modifying-captured-variables">6.8</a>. Both R and Python use dynamic lookup, which means you can’t reliably control <em>when</em> functions look for variables. Typos in variable names easily go undiscovered, and modified global variables can potentially wreak havoc on your overall program.</p>
<p>Fortunately it is difficult to modify global variables inside functions in both R and Python. This was also discussed in subsection <a href="functions.html#accessing-and-modifying-captured-variables">6.8</a>. In Python, you need to make use of the <code>global</code> keyword (mentioned in section <a href="functions.html#passing-by-assignment-in-python">6.7.2</a>), and in R, you need to use the rare super assignment operator (it looks like <code>&lt;&lt;-</code>, and it was mentioned in <a href="functions.html#passing-by-value-in-r">6.7.1</a>). Because these two symbols are so rare, they can serve as signals to viewers of your code about when and where (in which functions) global variables are being modified.</p>
<p>Last, violating the third criterion is easy in Python and difficult in R. This was discussed earlier in <a href="functions.html#modifying-a-functions-arguments">6.7</a>. Python can mutate/change arguments that have a mutable type because it has <em>pass-by-assignment</em> semantics (mentioned in section <a href="functions.html#passing-by-assignment-in-python">6.7.2</a>), and R generally can’t modify its arguments at all because it has <em>pass-by-value</em> semantics <a href="functions.html#passing-by-value-in-r">6.7.1</a>.</p>
<p>This chapter avoids the philosophical discussion of FP. Instead, it takes the applied approach, and provides instructions on how to use FP in your own programs. I try to give examples of <em>how</em> you can use FP, and <em>when</em> these tools are especially suitable.</p>
<p>One of the biggest tip-offs that you should be using functional programming is if you need to evaluate a single function many times, or in many different ways. This happens quite frequently in statistical computing. Instead of copy/pasting similar-looking lines of code, you might consider <em>higher-order</em> functions that take your function as an input, and intelligently call it in all the many ways you want it to. A third option you might also consider is to use a loop (c.f. <a href="control-flow.html#loops">11.2</a>). However, that approach is not very functional, and so it will not be heavily-discussed in this section.</p>
<p>Another tip-off that you need FP is if you need many different functions that are all “related” to one another. Should you define each function separately, using excessive copy/paste-ing? Or should you write a function that can elegantly generate any function you need?</p>
<p>Not repeating yourself and re-using code is a primary motivation, but it is not the only one. Another motivation for <strong>functional programming</strong> is clearly explained in <a href="https://adv-r.hadley.nz/fp.html">Advanced R</a><a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>:</p>
<blockquote>
<p>A functional style tends to create functions that can easily be analysed in isolation (i.e. using only local information), and hence is often much easier to automatically optimise or parallelise.</p>
</blockquote>
<p>All of these sound like a good things to have in our code, so let’s get started with some examples!</p>
<div id="functions-as-function-inputs-in-r" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.1</span> Functions as Function Inputs in R<a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many of the most commonly-used functionals in R have names that end in “apply”. The ones I discuss are <code>sapply()</code>, <code>vapply()</code>, <code>lapply()</code>, <code>apply()</code>, <code>tapply()</code> and <code>mapply()</code>. Each of these takes a function as one of its arguments. Recall that this is made possible by the fact that R has first-class functions.</p>
<div id="sapply-and-vapply" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.1</span> <code>sapply()</code> and <code>vapply()</code><a href="an-introduction-to-functional-programming.html#sapply-and-vapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have a <code>data.frame</code> that has 10 rows and 100 columns. What if we want to take the mean of each column?</p>
<p>An amateurish way to do this would be something like the following.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1">myFirstMean &lt;-<span class="st"> </span><span class="kw">mean</span>(myDF[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb263-2" title="2">mySecondMean &lt;-<span class="st"> </span><span class="kw">mean</span>(myDF[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb263-3" title="3"><span class="co"># ... so on and so forth ..</span></a>
<a class="sourceLine" id="cb263-4" title="4">myHundredthMean &lt;-<span class="st"> </span><span class="kw">mean</span>(myDF[,<span class="dv">100</span>])</a></code></pre></div>
<p>You will need one line of code for each column in the data frame! For data frames with a lot of columns, this becomes quite tedious. You should also ask yourself what happens to you and your collaborators when the data frame changes even slightly, or if you want to apply a different function to its columns. Third, the results are not stored in a single container. You are making it difficult on yourself if you want to use these variables in subsequent pieces of code.</p>
<div class="rmd-details">
<p>“Don’t repeat yourself” (DRY) is an idea that’s been around for a while and is widely accepted <span class="citation">(Hunt and Thomas <a href="#ref-hunt2000pragmatic">2000</a>)</span>. DRY is the opposite of <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself#WET">WET</a>.</p>
</div>
<p>Instead, prefer the use of <code>sapply()</code> in this situation. The “s” in <code>sapply()</code> stands for “simplified.” In this bit of code <code>mean()</code> is called on each column of the data frame. <code>sapply()</code> applies the function over columns, instead of rows, because data frames are internally a <code>list</code> of columns.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" title="1">myMeans &lt;-<span class="st"> </span><span class="kw">sapply</span>(myDF, mean)</a>
<a class="sourceLine" id="cb264-2" title="2">myMeans[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb264-3" title="3"><span class="co">##          X1          X2          X3          X4          X5 </span></a>
<a class="sourceLine" id="cb264-4" title="4"><span class="co">##  0.18577292  0.58759539 -0.05194271 -0.07027537 -0.35365358</span></a></code></pre></div>
<p>Each call to <code>mean()</code> returns a <code>double</code> <code>vector</code> of length <span class="math inline">\(1\)</span>. This is necessary if you want to collect all the results into a <code>vector</code>–remember, all elements of a <code>vector</code> have to have the same type. To get the same behavior, you might also consider using <code>vapply(myDF, mean, numeric(1))</code>.</p>
<p>In the above case, “simplify” referred to how one-hundred length-<span class="math inline">\(1\)</span> vectors were simplified into one length-<span class="math inline">\(100\)</span> <code>vector</code>. However, “simplified” does not necessarily imply that all elements will be stored in a <code>vector</code>. Consider the <code>summary</code> function, which returns a <code>double</code> <code>vector</code> of length <span class="math inline">\(6\)</span>. In this case, one-hundred length-<span class="math inline">\(6\)</span> vectors were simplified into one <span class="math inline">\(6 \times 100\)</span> matrix.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" title="1">mySummaries &lt;-<span class="st"> </span><span class="kw">sapply</span>(myDF, summary)</a>
<a class="sourceLine" id="cb265-2" title="2"><span class="kw">is.matrix</span>(mySummaries)</a>
<a class="sourceLine" id="cb265-3" title="3"><span class="co">## [1] TRUE</span></a>
<a class="sourceLine" id="cb265-4" title="4"><span class="kw">dim</span>(mySummaries)</a>
<a class="sourceLine" id="cb265-5" title="5"><span class="co">## [1]   6 100</span></a></code></pre></div>
<div class="rmd-details">
<p>Another function that is worth mentioning is <code>replicate()</code>–it is a wrapper for <code>sapply()</code>. Consider a situation where you want to call a function many times with the same inputs. You might try something like <code>sapply(1:100, function(elem) {  return(myFunc(someInput)) } )</code>. Another, more readable, way to do this is <code>replicate(100, myFunc(someInput))</code>.</p>
</div>
</div>
<div id="lapply" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.2</span> <code>lapply()</code><a href="an-introduction-to-functional-programming.html#lapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For functions that do not return amenable types that fit into a <code>vector</code>, <code>matrix</code> or <code>array</code>, they might need to be stored in <code>list</code>. In this situation, you would need <code>lapply()</code>. The “l” in <code>lapply()</code> stands for “list”. <code>lapply()</code> always returns a <code>list</code> of the same length as the <code>input</code>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1">regress &lt;-<span class="st"> </span><span class="cf">function</span>(y){ <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>) }</a>
<a class="sourceLine" id="cb266-2" title="2">myRegs &lt;-<span class="st"> </span><span class="kw">lapply</span>(myDF, regress)</a>
<a class="sourceLine" id="cb266-3" title="3"><span class="kw">length</span>(myRegs)</a>
<a class="sourceLine" id="cb266-4" title="4"><span class="co">## [1] 100</span></a>
<a class="sourceLine" id="cb266-5" title="5"><span class="kw">class</span>(myRegs[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb266-6" title="6"><span class="co">## [1] &quot;lm&quot;</span></a>
<a class="sourceLine" id="cb266-7" title="7"><span class="kw">summary</span>(myRegs[[<span class="dv">12</span>]])</a>
<a class="sourceLine" id="cb266-8" title="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb266-9" title="9"><span class="co">## Call:</span></a>
<a class="sourceLine" id="cb266-10" title="10"><span class="co">## lm(formula = y ~ 1)</span></a>
<a class="sourceLine" id="cb266-11" title="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb266-12" title="12"><span class="co">## Residuals:</span></a>
<a class="sourceLine" id="cb266-13" title="13"><span class="co">##     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb266-14" title="14"><span class="co">## -1.6149 -0.8692 -0.2541  0.7596  2.5718 </span></a>
<a class="sourceLine" id="cb266-15" title="15"><span class="co">## </span></a>
<a class="sourceLine" id="cb266-16" title="16"><span class="co">## Coefficients:</span></a>
<a class="sourceLine" id="cb266-17" title="17"><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)</span></a>
<a class="sourceLine" id="cb266-18" title="18"><span class="co">## (Intercept)   0.2104     0.4139   0.508    0.623</span></a>
<a class="sourceLine" id="cb266-19" title="19"><span class="co">## </span></a>
<a class="sourceLine" id="cb266-20" title="20"><span class="co">## Residual standard error: 1.309 on 9 degrees of freedom</span></a></code></pre></div>
</div>
<div id="apply" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.3</span> <code>apply()</code><a href="an-introduction-to-functional-programming.html#apply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I use <code>sapply()</code> and <code>lapply()</code> the most, personally. The next most common function I use is <code>apply()</code>. You can use it to apply functions to <em>rows</em> of rectangular arrays instead of columns. However, it can also apply functions over columns, just as the other functions we discussed can.<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" title="1"><span class="kw">dim</span>(myDF)</a>
<a class="sourceLine" id="cb267-2" title="2"><span class="co">## [1]  10 100</span></a>
<a class="sourceLine" id="cb267-3" title="3">results &lt;-<span class="st"> </span><span class="kw">apply</span>(myDF, <span class="dv">1</span>, mean)</a>
<a class="sourceLine" id="cb267-4" title="4">results[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb267-5" title="5"><span class="co">## [1]  0.18971263 -0.07595286  0.18400138  0.08895979</span></a></code></pre></div>
<p>Another example where it can be useful to apply a function to rows is <strong>predicate functions.</strong> A predicate function is just a fancy name for a function that returns a Boolean. I use them to filter out rows of a <code>data.frame</code>. Without a predicate function, filtering rows might look something like this on our real estate data <span class="citation">(Albemarle County Geographic Data Services Office <a href="#ref-albemarle_county_gis_web">2021</a>)</span> <span class="citation">(Ford <a href="#ref-clay_ford">2016</a>)</span>.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1">albRealEstate &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/albemarle_real_estate.csv&quot;</span>)</a>
<a class="sourceLine" id="cb268-2" title="2">firstB &lt;-<span class="st"> </span>albRealEstate<span class="op">$</span>YearBuilt <span class="op">==</span><span class="st"> </span><span class="dv">2006</span> </a>
<a class="sourceLine" id="cb268-3" title="3">secondB &lt;-<span class="st"> </span>albRealEstate<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;Average&quot;</span></a>
<a class="sourceLine" id="cb268-4" title="4">thirdB &lt;-<span class="st"> </span>albRealEstate<span class="op">$</span>City <span class="op">==</span><span class="st"> &quot;CROZET&quot;</span></a>
<a class="sourceLine" id="cb268-5" title="5">subDF &lt;-<span class="st"> </span>albRealEstate[(firstB <span class="op">&amp;</span><span class="st"> </span>secondB) <span class="op">|</span><span class="st"> </span>thirdB,]</a>
<a class="sourceLine" id="cb268-6" title="6"><span class="kw">str</span>(subDF, <span class="dt">strict.width =</span> <span class="st">&quot;cut&quot;</span>)</a>
<a class="sourceLine" id="cb268-7" title="7"><span class="co">## &#39;data.frame&#39;:    3865 obs. of  12 variables:</span></a>
<a class="sourceLine" id="cb268-8" title="8"><span class="co">##  $ YearBuilt    : int  1769 1818 2004 2006 2004 1995 1900 1960 ..</span></a>
<a class="sourceLine" id="cb268-9" title="9"><span class="co">##  $ YearRemodeled: int  1988 1991 NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb268-10" title="10"><span class="co">##  $ Condition    : chr  &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; ..</span></a>
<a class="sourceLine" id="cb268-11" title="11"><span class="co">##  $ NumStories   : num  1.7 2 1 1 1.5 2.3 2 1 1 1 ...</span></a>
<a class="sourceLine" id="cb268-12" title="12"><span class="co">##  $ FinSqFt      : int  5216 5160 1512 2019 1950 2579 1530 800 9..</span></a>
<a class="sourceLine" id="cb268-13" title="13"><span class="co">##  $ Bedroom      : int  4 6 3 3 3 3 4 2 2 2 ...</span></a>
<a class="sourceLine" id="cb268-14" title="14"><span class="co">##  $ FullBath     : int  3 4 2 3 3 2 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb268-15" title="15"><span class="co">##  $ HalfBath     : int  0 1 1 0 0 1 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb268-16" title="16"><span class="co">##  $ TotalRooms   : int  8 11 9 10 8 8 6 4 4 4 ...</span></a>
<a class="sourceLine" id="cb268-17" title="17"><span class="co">##  $ LotSize      : num  5.1 453.9 42.6 5 5.5 ...</span></a>
<a class="sourceLine" id="cb268-18" title="18"><span class="co">##  $ TotalValue   : num  1096600 2978600 677800 453200 389200 ...</span></a>
<a class="sourceLine" id="cb268-19" title="19"><span class="co">##  $ City         : chr  &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; ...</span></a></code></pre></div>
<p>Complicated filtering criteria can become quite wide, so I prefer to break the above code into three steps.</p>
<ul>
<li>Step 1: write a predicate function that returns TRUE or FALSE;</li>
<li>Step 2: construct a <code>logical</code> <code>vector</code> by <code>apply()</code>ing the predicate over rows;</li>
<li>Step 3: plug the <code>logical</code> <code>vector</code> into the <code>[</code> operator to remove the rows.</li>
</ul>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1">pred &lt;-<span class="st"> </span><span class="cf">function</span>(row){</a>
<a class="sourceLine" id="cb269-2" title="2">  yrBuiltCorrect &lt;-<span class="st"> </span>row[<span class="st">&#39;YearBuilt&#39;</span>] <span class="op">==</span><span class="st"> </span><span class="dv">2006</span></a>
<a class="sourceLine" id="cb269-3" title="3">  aveCond &lt;-<span class="st"> </span>row[<span class="st">&#39;Condition&#39;</span>] <span class="op">==</span><span class="st"> &quot;Average&quot;</span></a>
<a class="sourceLine" id="cb269-4" title="4">  inCrozet &lt;-<span class="st"> </span>row[<span class="st">&#39;City&#39;</span>] <span class="op">==</span><span class="st"> &quot;CROZET&quot;</span></a>
<a class="sourceLine" id="cb269-5" title="5">  ( yrBuiltCorrect <span class="op">&amp;&amp;</span><span class="st"> </span>aveCond) <span class="op">||</span><span class="st"> </span>inCrozet </a>
<a class="sourceLine" id="cb269-6" title="6">}</a>
<a class="sourceLine" id="cb269-7" title="7">whichRows &lt;-<span class="st"> </span><span class="kw">apply</span>(albRealEstate, <span class="dv">1</span>, pred)</a>
<a class="sourceLine" id="cb269-8" title="8">subDF &lt;-<span class="st"> </span>albRealEstate[whichRows,]</a>
<a class="sourceLine" id="cb269-9" title="9"><span class="kw">str</span>(subDF, <span class="dt">strict.width =</span> <span class="st">&quot;cut&quot;</span>)</a>
<a class="sourceLine" id="cb269-10" title="10"><span class="co">## &#39;data.frame&#39;:    3865 obs. of  12 variables:</span></a>
<a class="sourceLine" id="cb269-11" title="11"><span class="co">##  $ YearBuilt    : int  1769 1818 2004 2006 2004 1995 1900 1960 ..</span></a>
<a class="sourceLine" id="cb269-12" title="12"><span class="co">##  $ YearRemodeled: int  1988 1991 NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb269-13" title="13"><span class="co">##  $ Condition    : chr  &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; ..</span></a>
<a class="sourceLine" id="cb269-14" title="14"><span class="co">##  $ NumStories   : num  1.7 2 1 1 1.5 2.3 2 1 1 1 ...</span></a>
<a class="sourceLine" id="cb269-15" title="15"><span class="co">##  $ FinSqFt      : int  5216 5160 1512 2019 1950 2579 1530 800 9..</span></a>
<a class="sourceLine" id="cb269-16" title="16"><span class="co">##  $ Bedroom      : int  4 6 3 3 3 3 4 2 2 2 ...</span></a>
<a class="sourceLine" id="cb269-17" title="17"><span class="co">##  $ FullBath     : int  3 4 2 3 3 2 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb269-18" title="18"><span class="co">##  $ HalfBath     : int  0 1 1 0 0 1 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb269-19" title="19"><span class="co">##  $ TotalRooms   : int  8 11 9 10 8 8 6 4 4 4 ...</span></a>
<a class="sourceLine" id="cb269-20" title="20"><span class="co">##  $ LotSize      : num  5.1 453.9 42.6 5 5.5 ...</span></a>
<a class="sourceLine" id="cb269-21" title="21"><span class="co">##  $ TotalValue   : num  1096600 2978600 677800 453200 389200 ...</span></a>
<a class="sourceLine" id="cb269-22" title="22"><span class="co">##  $ City         : chr  &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; ...</span></a></code></pre></div>
</div>
<div id="tapply" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.4</span> <code>tapply()</code><a href="an-introduction-to-functional-programming.html#tapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>tapply()</code> can be very handy when you need it. First, we’ve alluded to the definition before in subsection <a href="data-frames.html#data-frames-in-r">8.1</a>, but a <strong>ragged array</strong> is a collection of arrays that all have potentially different lengths. I don’t typically construct such an object and then pass it to <code>tapply()</code>. Rather, I let <code>tapply()</code> construct the ragged array for me. The first argument it expects is, to quote the documentation, “typically vector-like,” while the second tells us how to break that <code>vector</code> into chunks. The third argument is a function that gets applied to each <code>vector</code> chunk.</p>
<p>If I wanted the average home price for each city, I could use something like this.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb270-1" title="1"><span class="kw">str</span>(albRealEstate, <span class="dt">strict.width =</span> <span class="st">&quot;cut&quot;</span>)</a>
<a class="sourceLine" id="cb270-2" title="2"><span class="co">## &#39;data.frame&#39;:    30381 obs. of  12 variables:</span></a>
<a class="sourceLine" id="cb270-3" title="3"><span class="co">##  $ YearBuilt    : int  1769 1818 2004 2006 2004 1995 1900 1960 ..</span></a>
<a class="sourceLine" id="cb270-4" title="4"><span class="co">##  $ YearRemodeled: int  1988 1991 NA NA NA NA NA NA NA NA ...</span></a>
<a class="sourceLine" id="cb270-5" title="5"><span class="co">##  $ Condition    : chr  &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; &quot;Average&quot; ..</span></a>
<a class="sourceLine" id="cb270-6" title="6"><span class="co">##  $ NumStories   : num  1.7 2 1 1 1.5 2.3 2 1 1 1 ...</span></a>
<a class="sourceLine" id="cb270-7" title="7"><span class="co">##  $ FinSqFt      : int  5216 5160 1512 2019 1950 2579 1530 800 9..</span></a>
<a class="sourceLine" id="cb270-8" title="8"><span class="co">##  $ Bedroom      : int  4 6 3 3 3 3 4 2 2 2 ...</span></a>
<a class="sourceLine" id="cb270-9" title="9"><span class="co">##  $ FullBath     : int  3 4 2 3 3 2 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb270-10" title="10"><span class="co">##  $ HalfBath     : int  0 1 1 0 0 1 0 0 0 0 ...</span></a>
<a class="sourceLine" id="cb270-11" title="11"><span class="co">##  $ TotalRooms   : int  8 11 9 10 8 8 6 4 4 4 ...</span></a>
<a class="sourceLine" id="cb270-12" title="12"><span class="co">##  $ LotSize      : num  5.1 453.9 42.6 5 5.5 ...</span></a>
<a class="sourceLine" id="cb270-13" title="13"><span class="co">##  $ TotalValue   : num  1096600 2978600 677800 453200 389200 ...</span></a>
<a class="sourceLine" id="cb270-14" title="14"><span class="co">##  $ City         : chr  &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; &quot;CROZET&quot; ...</span></a>
<a class="sourceLine" id="cb270-15" title="15"><span class="kw">length</span>(<span class="kw">unique</span>(albRealEstate<span class="op">$</span>City))</a>
<a class="sourceLine" id="cb270-16" title="16"><span class="co">## [1] 6</span></a>
<a class="sourceLine" id="cb270-17" title="17"><span class="kw">tapply</span>(albRealEstate<span class="op">$</span>TotalValue, <span class="kw">list</span>(albRealEstate<span class="op">$</span>City), mean)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]</a>
<a class="sourceLine" id="cb270-18" title="18"><span class="co">## CHARLOTTESVILLE          CROZET     EARLYSVILLE         KESWICK </span></a>
<a class="sourceLine" id="cb270-19" title="19"><span class="co">##        429926.5        436090.5        482711.4        565985.1</span></a></code></pre></div>
<p>You might be wondering why we put <code>albRealEstate$City</code> into a <code>list</code>. That seems kind of unnecessary. This is because <code>tapply()</code> can be used with multiple <code>factor</code>s–this will break down the <code>vector</code> input into a finer partition. The second argument must be one object, though, so all of these <code>factor</code>s must be collected into a <code>list</code>. The following code produces a “pivot table.”</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">pivTable &lt;-<span class="st"> </span><span class="kw">tapply</span>(albRealEstate<span class="op">$</span>TotalValue, </a>
<a class="sourceLine" id="cb271-2" title="2">                   <span class="kw">list</span>(albRealEstate<span class="op">$</span>City, albRealEstate<span class="op">$</span>Condition), </a>
<a class="sourceLine" id="cb271-3" title="3">                   mean)</a>
<a class="sourceLine" id="cb271-4" title="4">pivTable[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb271-5" title="5"><span class="co">##                  Average Excellent     Fair     Good     Poor</span></a>
<a class="sourceLine" id="cb271-6" title="6"><span class="co">## CHARLOTTESVILLE 416769.9  625887.9 306380.7 529573.4 304922.4</span></a>
<a class="sourceLine" id="cb271-7" title="7"><span class="co">## CROZET          447585.8  401553.5 241568.8 466798.5 224516.2</span></a>
<a class="sourceLine" id="cb271-8" title="8"><span class="co">## EARLYSVILLE     491269.6  492848.4 286980.0 522938.5 250773.3</span></a>
<a class="sourceLine" id="cb271-9" title="9"><span class="co">## KESWICK         565994.3  664443.5 274270.4 676312.6 172425.0</span></a>
<a class="sourceLine" id="cb271-10" title="10"><span class="co">## NORTH GARDEN    413788.8  529108.3 164646.2 591502.8 161460.0</span></a>
<a class="sourceLine" id="cb271-11" title="11"><span class="co">## SCOTTSVILLE     286787.4  534500.0 196003.4 415207.5 183942.3</span></a></code></pre></div>
<div class="rmd-details">
<p>For functions that return higher-dimensional output, you will have to use something like <code>by()</code> or <code>aggregate()</code> in place of <code>tapply()</code>.</p>
</div>
</div>
<div id="mapply" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.5</span> <code>mapply()</code><a href="an-introduction-to-functional-programming.html#mapply" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/mapply.html">documentation of <code>mapply()</code></a> states <code>mapply()</code> is a multivariate version of <code>sapply()</code>. <code>sapply()</code> worked with univariate functions; the function was called multiple times, but each time with a single argument. If you have a function that takes <em>multiple arguments</em>, and you want those arguments to change each time the function is called, then you might be able to use <code>mapply()</code>.</p>
<p>Here is a short example. Regarding the <code>n=</code> argument of <code>rnorm()</code>, the documentation explains, “[i]f <code>length(n) &gt; 1</code>, the length is taken to be the number required.” This would be a problem if we want to sample three times from a mean <span class="math inline">\(0\)</span> normal first, then twice from a mean <span class="math inline">\(100\)</span> normal, and then third, once from a mean <span class="math inline">\(42\)</span> normal distribution. We only get three samples when we want six!</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1"><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">42</span>), <span class="dt">sd =</span> <span class="kw">c</span>(.<span class="dv">01</span>, <span class="fl">.01</span>, <span class="fl">.01</span>))</a></code></pre></div>
<pre><code>## [1]  0.01435773 99.99238144 42.01743548</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1"><span class="kw">mapply</span>(rnorm, <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">42</span>), <span class="dt">sd =</span> <span class="kw">c</span>(.<span class="dv">01</span>, <span class="fl">.01</span>, <span class="fl">.01</span>))</a></code></pre></div>
<pre><code>## [[1]]
## [1] -0.0122999207 -0.0064744814 -0.0002297629
## 
## [[2]]
## [1] 100.02077  99.99853
## 
## [[3]]
## [1] 41.99704</code></pre>
</div>
<div id="reduce-and-do.call" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.1.6</span> <code>Reduce()</code> and <code>do.call()</code><a href="an-introduction-to-functional-programming.html#reduce-and-do.call" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unlike the other examples of functions that take other functions as inputs, <code>Reduce()</code> and <code>do.call()</code> don’t have many outputs. Instead of collecting many outputs into a container, they just output one thing.</p>
<p>Let’s start with an example: “combining” data sets. In section <a href="reshaping-and-combining-data-sets.html#reshaping-and-combining-data-sets">12</a> we talked about several different ways of combining data sets. We discussed stacking data sets on top of one another with <code>rbind()</code> (c.f. subsection <a href="reshaping-and-combining-data-sets.html#stacking-data-sets-and-placing-them-shoulder-to-shoulder">12.2</a>), stacking them side-by-side with <code>cbind()</code> (also in <a href="reshaping-and-combining-data-sets.html#stacking-data-sets-and-placing-them-shoulder-to-shoulder">12.2</a>), and intelligently joining them together with <code>merge()</code> (c.f. <a href="reshaping-and-combining-data-sets.html#merging-or-joining-data-sets">12.3</a>).</p>
<p>Now consider the task of combining <em>many</em> data sets. How can we combine three or more data sets into one? Also, how do we write DRY code and abide by the DRY principle? As the name of the subsection suggests, we can use either <code>Reduce()</code> or <code>do.call()</code> as a higher-order function. Just like the aforementioned <code>*apply()</code> functions, they take in either <code>cbind()</code>, <code>rbind()</code>, or <code>merge()</code> as a function input. Which one do we pick, though? The answer to that question deals with <em>how many arguments our lower-order function takes.</em></p>
<p>Take a look at the documentation to <code>rbind()</code>. Its first argument is <code>...</code>, which is the <a href="https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Dot_002ddot_002ddot">dot-dot-dot</a> symbol. This means <code>rbind()</code> can take a varying number of <code>data.frame</code>s to stack on top of each other. In other words, <code>rbind()</code> is <strong>variadic</strong>.</p>
<p>On the other hand, take a look at the documentation of <code>merge()</code>. It only takes two <code>data.frame</code>s at a time<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a>. If we want to combine many data sets, <code>merge()</code> needs a helper function.</p>
<p>This is the difference between <code>Reduce()</code> and <code>do.call()</code>. <code>do.call()</code> calls a function once on many arguments, so its function must be able to handle many arguments. On the other hand, <code>Reduce()</code> calls a binary function many times on pairs of arguments. <code>Reduce()</code>’s function argument gets called on the first two elements, then on the first output and the third element, then on the second output and fourth element, and so on.</p>
<p>Here is an initial example that makes use of four data sets <code>d1.csv</code>, <code>d2.csv</code>, <code>d3.csv</code>, and <code>d4.csv</code>. To start, ask yourself how we would read all of these in. There is a temptation to copy and paste <code>read.csv</code> calls, but that would violate the DRY principle. Instead, let’s use <code>lapply()</code> an anonymous function that constructs a file path string, and then uses it to read in the data set the string refers to.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1">numDataSets &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb276-2" title="2">dataSets &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;d&quot;</span>,<span class="dv">1</span><span class="op">:</span>numDataSets)</a>
<a class="sourceLine" id="cb276-3" title="3">dfs &lt;-<span class="st"> </span><span class="kw">lapply</span>(dataSets, </a>
<a class="sourceLine" id="cb276-4" title="4">              <span class="cf">function</span>(name) <span class="kw">read.csv</span>(<span class="kw">paste0</span>(<span class="st">&quot;data/&quot;</span>, name, <span class="st">&quot;.csv&quot;</span>)))</a>
<a class="sourceLine" id="cb276-5" title="5"><span class="kw">head</span>(dfs[[<span class="dv">3</span>]])</a>
<a class="sourceLine" id="cb276-6" title="6"><span class="co">##   id obs3</span></a>
<a class="sourceLine" id="cb276-7" title="7"><span class="co">## 1  a    7</span></a>
<a class="sourceLine" id="cb276-8" title="8"><span class="co">## 2  b    8</span></a>
<a class="sourceLine" id="cb276-9" title="9"><span class="co">## 3  c    9</span></a></code></pre></div>
<p>Notice how the above code would only need to be changed by one character if we wanted to increase the number of data sets being read in!<a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a></p>
<p>Next, <code>cbind()</code>ing them all together can be done as follows. <code>do.call()</code> will call the function only once. <code>cbind()</code> takes many arguments at once, so this works. This code is even better than the above code in that if <code>dfs</code> becomes longer, or changes at all, <em>nothing</em> will need to be changed.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1"><span class="kw">do.call</span>(cbind, dfs) <span class="co"># DRY! :)</span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="co">##   id obs1 id obs2 id obs3 id obs4</span></a>
<a class="sourceLine" id="cb277-3" title="3"><span class="co">## 1  a    1  b    5  a    7  a   10</span></a>
<a class="sourceLine" id="cb277-4" title="4"><span class="co">## 2  b    2  a    4  b    8  b   11</span></a>
<a class="sourceLine" id="cb277-5" title="5"><span class="co">## 3  c    3  c    6  c    9  c   12</span></a>
<a class="sourceLine" id="cb277-6" title="6"><span class="co"># cbind(df1,df2,df3,df4) # WET! :(</span></a></code></pre></div>
<p>What if we wanted to <code>merge()</code> all these data sets together? After all, the <code>id</code> column appears to be repeating itself, and some data from <code>d2</code> isn’t lining up.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="kw">Reduce</span>(merge, dfs)</a>
<a class="sourceLine" id="cb278-2" title="2"><span class="co">##   id obs1 obs2 obs3 obs4</span></a>
<a class="sourceLine" id="cb278-3" title="3"><span class="co">## 1  a    1    4    7   10</span></a>
<a class="sourceLine" id="cb278-4" title="4"><span class="co">## 2  b    2    5    8   11</span></a>
<a class="sourceLine" id="cb278-5" title="5"><span class="co">## 3  c    3    6    9   12</span></a></code></pre></div>
<p>Again, this is very DRY code. Nothing would need to be changed if <code>dfs</code> grew. Furthermore, trying to <code>do.call()</code> the <code>merge()</code> function wouldn’t work because it can only take two data sets at a time.</p>
</div>
</div>
<div id="functions-as-function-inputs-in-python" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.2</span> Functions as Function Inputs in Python<a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-python" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="functions-as-function-inputs-in-base-python" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.2.1</span> Functions as Function Inputs in Base Python<a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-base-python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I discuss two functions from base Python that take functions as input. Neither return a <code>list</code> or a <code>np.array</code>, but they do return different kinds of <strong>iterables</strong>, which are “objects capable of returning their members one at a time,” <a href="https://docs.python.org/3/glossary.html">according to the Python documentation.</a> <code>map()</code>, the function, will return objects of type <code>map</code>. <code>filter()</code>, the function, will return objects of type <code>filter</code>. Often times we will just convert these to the container we are more familiar with.</p>
<div id="map" class="section level4 hasAnchor">
<h4><span class="header-section-number">15.2.1.1</span> <code>map()</code><a href="an-introduction-to-functional-programming.html#map" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://docs.python.org/3/library/functions.html#map"><code>map()</code></a> can call a function repeatedly using elements of a container as inputs. Here is an example of calculating outputs of a <em>spline</em> function, which can be useful for coming up with predictors in regression models. This particular spline function is <span class="math inline">\(f(x) = (x-k)1(x \ge k)\)</span>, where <span class="math inline">\(k\)</span> is some chosen “knot point.”</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb279-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb279-2" title="2">my_inputs <span class="op">=</span> np.linspace(start <span class="op">=</span> <span class="dv">0</span>, stop <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.pi)</a>
<a class="sourceLine" id="cb279-3" title="3"><span class="kw">def</span> spline(x):</a>
<a class="sourceLine" id="cb279-4" title="4">    knot <span class="op">=</span> <span class="fl">3.0</span></a>
<a class="sourceLine" id="cb279-5" title="5">    <span class="cf">if</span> x <span class="op">&gt;=</span> knot:</a>
<a class="sourceLine" id="cb279-6" title="6">        <span class="cf">return</span> x<span class="op">-</span>knot</a>
<a class="sourceLine" id="cb279-7" title="7">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb279-8" title="8">        <span class="cf">return</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb279-9" title="9">output <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(spline, my_inputs))</a></code></pre></div>
<p>We can visualize the mathematical function by plotting its outputs against its inputs. More information on visualization was given in subsection <a href="visualization.html#visualization">13</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spline-plot"></span>
<img src="pics/spline.png" alt="Our Spline Function" width="80%" />
<p class="caption">
Figure 15.1: Our Spline Function
</p>
</div>
<p><code>map()</code> can also be used like <code>mapply()</code>. In other words, you can apply it to two containers,</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb280-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb280-2" title="2">x <span class="op">=</span> np.linspace(start <span class="op">=</span> <span class="fl">-1.</span>, stop <span class="op">=</span> <span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb280-3" title="3">y <span class="op">=</span> np.linspace(start <span class="op">=</span> <span class="fl">-1.</span>, stop <span class="op">=</span> <span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb280-4" title="4"><span class="kw">def</span> f(x,y):</a>
<a class="sourceLine" id="cb280-5" title="5">    <span class="cf">return</span> np.log(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb280-6" title="6"><span class="bu">list</span>(<span class="bu">map</span>(f, x, y))[:<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb280-7" title="7"><span class="co">## [0.6931471805599453, 0.6098017877588092, 0.5228315638793316]</span></a></code></pre></div>
</div>
<div id="filter" class="section level4 hasAnchor">
<h4><span class="header-section-number">15.2.1.2</span> <code>filter()</code><a href="an-introduction-to-functional-programming.html#filter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><a href="https://docs.python.org/3/library/functions.html#filter"><code>filter()</code></a> helps remove unwanted elements from a container. It returns an iterable of type <code>filter</code>, which we can iterate over or convert to a more familiar type of container. In this example, I iterate over it without converting it.</p>
<p>This code also provides our first example of a <a href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions"><strong>lambda function</strong></a> <span class="citation">(Lutz <a href="#ref-Lutz13">2013</a>)</span>. Lambda functions are simply another way to define functions. Notice that in this example, we didn’t have to name our function. In other words, it was <strong>anonymous</strong>. We can also save a few lines of code.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb281-1" title="1">raw_data <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="fl">1.45</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb281-2" title="2"><span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">filter</span>(<span class="kw">lambda</span> x : x<span class="op">**</span><span class="dv">2</span> <span class="op">&gt;</span> <span class="dv">2</span>, raw_data):</a>
<a class="sourceLine" id="cb281-3" title="3">    <span class="bu">print</span>(elem)</a>
<a class="sourceLine" id="cb281-4" title="4"><span class="co">## 1.42</span></a>
<a class="sourceLine" id="cb281-5" title="5"><span class="co">## 1.43</span></a>
<a class="sourceLine" id="cb281-6" title="6"><span class="co">## 1.44</span></a></code></pre></div>
</div>
</div>
<div id="functions-as-function-inputs-in-numpy" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.2.2</span> Functions as Function Inputs in Numpy<a href="an-introduction-to-functional-programming.html#functions-as-function-inputs-in-numpy" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Numpy provides a <a href="https://numpy.org/doc/stable/reference/routines.functional.html">number of functions</a> that facilitate working with <code>np.ndarray</code>s in a functional style. For example, <a href="https://numpy.org/doc/stable/reference/generated/numpy.apply_along_axis.html"><code>np.apply_along_axis()</code></a> is similar to R’s <code>apply()</code>. <code>apply()</code> had a <code>MARGIN=</code> input (<code>1</code> sums rows, <code>2</code> sums columns), whereas this function has a <code>axis=</code> input (<code>0</code> sums columns, <code>1</code> sums rows).</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb282-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb282-2" title="2">my_array <span class="op">=</span> np.arange(<span class="dv">6</span>).reshape((<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb282-3" title="3">my_array</a>
<a class="sourceLine" id="cb282-4" title="4"><span class="co">## array([[0, 1, 2],</span></a>
<a class="sourceLine" id="cb282-5" title="5"><span class="co">##        [3, 4, 5]])</span></a>
<a class="sourceLine" id="cb282-6" title="6">np.apply_along_axis(<span class="bu">sum</span>, <span class="dv">0</span>, my_array) <span class="co"># summing columns</span></a>
<a class="sourceLine" id="cb282-7" title="7"><span class="co">## array([3, 5, 7])</span></a>
<a class="sourceLine" id="cb282-8" title="8">np.apply_along_axis(<span class="bu">sum</span>, <span class="dv">1</span>, my_array) <span class="co"># summing rows</span></a>
<a class="sourceLine" id="cb282-9" title="9"><span class="co">## array([ 3, 12])</span></a></code></pre></div>
</div>
<div id="functional-methods-in-pandas" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.2.3</span> Functional Methods in Pandas<a href="an-introduction-to-functional-programming.html#functional-methods-in-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pandas’ <code>DataFrame</code>s have an <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html"><code>.apply()</code> method</a> that is very similar to <code>apply()</code> in R,<a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a> but again, just like the above function, you have to think about an <code>axis=</code> argument instead of a <code>MARGIN=</code> argument.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb283-1" title="1"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb283-2" title="2">alb_real_est <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/albemarle_real_estate.csv&quot;</span>)</a>
<a class="sourceLine" id="cb283-3" title="3">alb_real_est.shape</a>
<a class="sourceLine" id="cb283-4" title="4"><span class="co">## (30381, 12)</span></a>
<a class="sourceLine" id="cb283-5" title="5">alb_real_est.<span class="bu">apply</span>(<span class="bu">len</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># length of columns</span></a>
<a class="sourceLine" id="cb283-6" title="6"><span class="co">## YearBuilt        30381</span></a>
<a class="sourceLine" id="cb283-7" title="7"><span class="co">## YearRemodeled    30381</span></a>
<a class="sourceLine" id="cb283-8" title="8"><span class="co">## Condition        30381</span></a>
<a class="sourceLine" id="cb283-9" title="9"><span class="co">## NumStories       30381</span></a>
<a class="sourceLine" id="cb283-10" title="10"><span class="co">## FinSqFt          30381</span></a>
<a class="sourceLine" id="cb283-11" title="11"><span class="co">## Bedroom          30381</span></a>
<a class="sourceLine" id="cb283-12" title="12"><span class="co">## FullBath         30381</span></a>
<a class="sourceLine" id="cb283-13" title="13"><span class="co">## HalfBath         30381</span></a>
<a class="sourceLine" id="cb283-14" title="14"><span class="co">## TotalRooms       30381</span></a>
<a class="sourceLine" id="cb283-15" title="15"><span class="co">## LotSize          30381</span></a>
<a class="sourceLine" id="cb283-16" title="16"><span class="co">## TotalValue       30381</span></a>
<a class="sourceLine" id="cb283-17" title="17"><span class="co">## City             30381</span></a>
<a class="sourceLine" id="cb283-18" title="18"><span class="co">## dtype: int64</span></a>
<a class="sourceLine" id="cb283-19" title="19"><span class="bu">type</span>(alb_real_est.<span class="bu">apply</span>(<span class="bu">len</span>, axis<span class="op">=</span><span class="dv">1</span>)) <span class="co"># length of rows</span></a>
<a class="sourceLine" id="cb283-20" title="20"><span class="co">## &lt;class &#39;pandas.core.series.Series&#39;&gt;</span></a></code></pre></div>
<p>Another thing to keep in mind is that <code>DataFrame</code>s, unlike <code>ndarray</code>s, don’t have to have the same type for all elements. If you have mixed column types, then summing rows, for instance, might not make sense. This just requires subsetting columns before <code>.apply()</code>ing a function to rows. Here is an example of computing each property’s “score”.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb284-1" title="1"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb284-2" title="2"><span class="co"># alb_real_est.apply(sum, axis=1) # can&#39;t add letters to numbers!</span></a>
<a class="sourceLine" id="cb284-3" title="3"><span class="kw">def</span> get_prop_score(row):</a>
<a class="sourceLine" id="cb284-4" title="4">    <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>row[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>row[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb284-5" title="5">two_col_df <span class="op">=</span> alb_real_est[[<span class="st">&#39;FinSqFt&#39;</span>,<span class="st">&#39;LotSize&#39;</span>]]</a>
<a class="sourceLine" id="cb284-6" title="6">alb_real_est[<span class="st">&#39;Score&#39;</span>] <span class="op">=</span> two_col_df.<span class="bu">apply</span>(get_prop_score, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb284-7" title="7">alb_real_est[[<span class="st">&#39;FinSqFt&#39;</span>,<span class="st">&#39;LotSize&#39;</span>,<span class="st">&#39;Score&#39;</span>]].head(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb284-8" title="8"><span class="co">##    FinSqFt  LotSize      Score</span></a>
<a class="sourceLine" id="cb284-9" title="9"><span class="co">## 0     5216    5.102  10447.306</span></a>
<a class="sourceLine" id="cb284-10" title="10"><span class="co">## 1     5160  453.893  11681.679</span></a></code></pre></div>
<p><code>.apply()</code> also works with more than one function at a time.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb285-1" title="1">alb_real_est[[<span class="st">&#39;FinSqFt&#39;</span>,<span class="st">&#39;LotSize&#39;</span>]].<span class="bu">apply</span>([<span class="bu">sum</span>, <span class="bu">len</span>])</a>
<a class="sourceLine" id="cb285-2" title="2"><span class="co">##       FinSqFt      LotSize</span></a>
<a class="sourceLine" id="cb285-3" title="3"><span class="co">## sum  61730306  105063.1892</span></a>
<a class="sourceLine" id="cb285-4" title="4"><span class="co">## len     30381   30381.0000</span></a></code></pre></div>
<p>If you do not want to waste two lines defining a function with <code>def</code>, you can use an anonymous lambda function. Be careful, though–if your function is complex enough, then your lines will get quite wide. For instance, this example is pushing it.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb286-1" title="1">two_col_df.<span class="bu">apply</span>(<span class="kw">lambda</span> row : <span class="bu">sum</span>(row<span class="op">*</span>[<span class="dv">2</span>,<span class="dv">3</span>]), <span class="dv">1</span>)[:<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb286-2" title="2"><span class="co">## 0    10447.306</span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="co">## 1    11681.679</span></a>
<a class="sourceLine" id="cb286-4" title="4"><span class="co">## 2     3151.770</span></a>
<a class="sourceLine" id="cb286-5" title="5"><span class="co">## dtype: float64</span></a></code></pre></div>
<p>The previous example <code>.apply()</code>s a <em>binary</em> function to each row. The function is binary because it takes two elements at a time. If you want to apply a <em>unary</em> function (i.e. it takes one argument at a time) function to each row for, and for each column, then you can use <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.applymap.html#pandas.DataFrame.applymap"><code>.applymap()</code></a>.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb287-1" title="1">alb_real_est[[<span class="st">&#39;FinSqFt&#39;</span>,<span class="st">&#39;LotSize&#39;</span>]].applymap(<span class="kw">lambda</span> e : e <span class="op">+</span> <span class="dv">1</span>).head(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb287-2" title="2"><span class="co">##    FinSqFt  LotSize</span></a>
<a class="sourceLine" id="cb287-3" title="3"><span class="co">## 0     5217    6.102</span></a>
<a class="sourceLine" id="cb287-4" title="4"><span class="co">## 1     5161  454.893</span></a>
<a class="sourceLine" id="cb287-5" title="5"><span class="co">## 2     1513   43.590</span></a></code></pre></div>
<p>Last, we have a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html"><code>.groupby()</code></a> method, which can be used to mirror the behavior of R’s <code>tapply()</code>, <code>aggregate()</code> or <code>by()</code>. It can take the <code>DataFrame</code> it belongs to, and group its rows into multiple sub-<code>DataFrame</code>s. The collection of sub-<code>DataFrames</code> has a lot of the same methods that an individual <code>DataFrame</code> has (e.g. the subsetting operators, and the <code>.apply()</code> method), which can all be used in a second step of calculating things on each sub-<code>DataFrame</code>.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb288-1" title="1"><span class="bu">type</span>(alb_real_est.groupby([<span class="st">&#39;City&#39;</span>]))</a>
<a class="sourceLine" id="cb288-2" title="2"><span class="co">## pandas.core.groupby.generic.DataFrameGroupBy</span></a>
<a class="sourceLine" id="cb288-3" title="3"><span class="bu">type</span>(alb_real_est.groupby([<span class="st">&#39;City&#39;</span>])[<span class="st">&#39;TotalValue&#39;</span>])</a>
<a class="sourceLine" id="cb288-4" title="4"><span class="co">## pandas.core.groupby.generic.SeriesGroupBy</span></a></code></pre></div>
<p>Here is an example that models some pretty typical functionality. It shows two ways to get the average home price by city. The first line groups the rows by which <code>City</code> they are in, extracts the <code>TotalValue</code> column in each sub-<code>DataFrame</code>, and then <code>.apply()</code>s the <code>np.average()</code> function on the sole column found in each sub-<code>DataFrame</code>. The second <code>.apply()</code>s a lambda function to each sub-<code>DataFrame</code> directly. More details on this “split-apply-combine” strategy can be found in the <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">Pandas documentation.</a></p>
<div class="sourceCode" id="cb289"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb289-1" title="1">grouped <span class="op">=</span> alb_real_est.groupby([<span class="st">&#39;City&#39;</span>])</a>
<a class="sourceLine" id="cb289-2" title="2">grouped[<span class="st">&#39;TotalValue&#39;</span>].<span class="bu">apply</span>(np.average)</a>
<a class="sourceLine" id="cb289-3" title="3"><span class="co">## City</span></a>
<a class="sourceLine" id="cb289-4" title="4"><span class="co">## CHARLOTTESVILLE    429926.502708</span></a>
<a class="sourceLine" id="cb289-5" title="5"><span class="co">## CROZET             436090.502541</span></a>
<a class="sourceLine" id="cb289-6" title="6"><span class="co">## EARLYSVILLE        482711.437566</span></a>
<a class="sourceLine" id="cb289-7" title="7"><span class="co">## KESWICK            565985.092025</span></a>
<a class="sourceLine" id="cb289-8" title="8"><span class="co">## NORTH GARDEN       399430.221519</span></a>
<a class="sourceLine" id="cb289-9" title="9"><span class="co">## SCOTTSVILLE        293666.758242</span></a>
<a class="sourceLine" id="cb289-10" title="10"><span class="co">## Name: TotalValue, dtype: float64</span></a>
<a class="sourceLine" id="cb289-11" title="11">grouped.<span class="bu">apply</span>(<span class="kw">lambda</span> df : np.average(df[<span class="st">&#39;TotalValue&#39;</span>]))</a>
<a class="sourceLine" id="cb289-12" title="12"><span class="co">## City</span></a>
<a class="sourceLine" id="cb289-13" title="13"><span class="co">## CHARLOTTESVILLE    429926.502708</span></a>
<a class="sourceLine" id="cb289-14" title="14"><span class="co">## CROZET             436090.502541</span></a>
<a class="sourceLine" id="cb289-15" title="15"><span class="co">## EARLYSVILLE        482711.437566</span></a>
<a class="sourceLine" id="cb289-16" title="16"><span class="co">## KESWICK            565985.092025</span></a>
<a class="sourceLine" id="cb289-17" title="17"><span class="co">## NORTH GARDEN       399430.221519</span></a>
<a class="sourceLine" id="cb289-18" title="18"><span class="co">## SCOTTSVILLE        293666.758242</span></a>
<a class="sourceLine" id="cb289-19" title="19"><span class="co">## dtype: float64</span></a></code></pre></div>
</div>
</div>
<div id="functions-as-function-outputs-in-r" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.3</span> Functions as Function Outputs in R<a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Functions that create and return other functions are sometimes called <strong>function factories.</strong> Functions are first-class objects in R, so it’s easy to return them. What’s more interesting is that supposedly temporary objects inside the outer function can be accessed during the call of the inner function after it’s returned.</p>
<p>Here is a first quick example.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1">funcFactory &lt;-<span class="st"> </span><span class="cf">function</span>(greetingMessage){</a>
<a class="sourceLine" id="cb290-2" title="2">  <span class="cf">function</span>(name){</a>
<a class="sourceLine" id="cb290-3" title="3">    <span class="kw">paste</span>(greetingMessage, name)</a>
<a class="sourceLine" id="cb290-4" title="4">  }</a>
<a class="sourceLine" id="cb290-5" title="5">}</a>
<a class="sourceLine" id="cb290-6" title="6">greetWithHello &lt;-<span class="st"> </span><span class="kw">funcFactory</span>(<span class="st">&quot;Hello&quot;</span>)</a>
<a class="sourceLine" id="cb290-7" title="7"><span class="kw">greetWithHello</span>(<span class="st">&quot;Taylor&quot;</span>)</a>
<a class="sourceLine" id="cb290-8" title="8"><span class="co">## [1] &quot;Hello Taylor&quot;</span></a>
<a class="sourceLine" id="cb290-9" title="9"><span class="kw">greetWithHello</span>(<span class="st">&quot;Charlie&quot;</span>)</a>
<a class="sourceLine" id="cb290-10" title="10"><span class="co">## [1] &quot;Hello Charlie&quot;</span></a></code></pre></div>
<p>Notice that <strong>the <code>greetingMessage=</code> argument that is passed in, <code>"Hello"</code>, isn’t temporary anymore.</strong> It lives on so it can be used by all the functions created by <code>funcFactory()</code>. This is the most surprising aspect of writing function factories.</p>
<p>Let’s now consider a more complicated and realistic example. Let’s implement a variance reduction technique called <strong>common random numbers</strong>.</p>
<p>Suppose <span class="math inline">\(X \sim \text{Normal}(\mu, \sigma^2)\)</span>, and we are interested in approximating an expectation of a function of this random variable. Suppose that we don’t know that
<span class="math display">\[\begin{equation} 
\mathbb{E}[\sin(X)] = \sin(\mu) \exp\left(-\frac{\sigma^2}{2}\right)
\end{equation}\]</span>
for any particular choice of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span>, and instead, we choose to use the Monte Carlo method:
<span class="math display">\[\begin{equation} 
\hat{\mathbb{E}}[\sin(X)] = \frac{1}{n}\sum_{i=1}^n\sin(X^i)
\end{equation}\]</span>
where <span class="math inline">\(X^1, \ldots, X^n \overset{\text{iid}}{\sim} \text{Normal}(\mu, \sigma^2)\)</span> is a large collection of draws from the appropriate normal distribution, probably coming from a call to <code>rnorm()</code>. In more realistic situations, the theoretical expectation might not be tractable, either because the random variable has a complicated distribution, or maybe because the functional is very complicated. In these cases, a tool like Monte Carlo might be the only available approach.</p>
<p>Here are two functions that calculate the above quantities for <span class="math inline">\(n=1000\)</span>. <code>actualExpectSin()</code> is a function that computes the theoretical expectation for any particular parameter pair. <code>monteCarloSin()</code> is a function that implements the Monte Carlo approximate expectation.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1">n &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># don&#39;t hardcode variables that aren&#39;t passed as arguments!</span></a>
<a class="sourceLine" id="cb291-2" title="2">actualExpectSin &lt;-<span class="st"> </span><span class="cf">function</span>(params){</a>
<a class="sourceLine" id="cb291-3" title="3">  <span class="kw">stopifnot</span>(params[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="co"># second parameter is sigma</span></a>
<a class="sourceLine" id="cb291-4" title="4">  <span class="kw">sin</span>(params[<span class="dv">1</span>])<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>.<span class="dv">5</span><span class="op">*</span>(params[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb291-5" title="5">}</a>
<a class="sourceLine" id="cb291-6" title="6">monteCarloSin &lt;-<span class="st"> </span><span class="cf">function</span>(params){</a>
<a class="sourceLine" id="cb291-7" title="7">  <span class="kw">stopifnot</span>(params[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb291-8" title="8">  <span class="kw">mean</span>(<span class="kw">sin</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> params[<span class="dv">1</span>], <span class="dt">sd =</span> params[<span class="dv">2</span>])))</a>
<a class="sourceLine" id="cb291-9" title="9">}</a>
<a class="sourceLine" id="cb291-10" title="10"><span class="co"># monteCarloSin(c(10,1))</span></a></code></pre></div>
<p>One-off approximations aren’t as interesting as visualizing many expectations for many parameter inputs. Below we plot the expectations for many different parameter vectors/configurations/settings.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1">muGrid &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">10</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb292-2" title="2">sigmaGrid &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">001</span>, <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb292-3" title="3">muSigmaGrid &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(muGrid, sigmaGrid)</a>
<a class="sourceLine" id="cb292-4" title="4">actuals &lt;-<span class="st">  </span><span class="kw">matrix</span>(<span class="kw">apply</span>(muSigmaGrid, <span class="dv">1</span>, actualExpectSin), </a>
<a class="sourceLine" id="cb292-5" title="5">                   <span class="dt">ncol =</span> <span class="kw">length</span>(muGrid))</a>
<a class="sourceLine" id="cb292-6" title="6">mcApprox &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(muSigmaGrid, <span class="dv">1</span>, monteCarloSin), </a>
<a class="sourceLine" id="cb292-7" title="7">                   <span class="dt">ncol =</span> <span class="kw">length</span>(muGrid))</a>
<a class="sourceLine" id="cb292-8" title="8"></a>
<a class="sourceLine" id="cb292-9" title="9"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb292-10" title="10"><span class="kw">contour</span>(muGrid, sigmaGrid, actuals, </a>
<a class="sourceLine" id="cb292-11" title="11">        <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;sigma&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;actual expects&quot;</span>)</a>
<a class="sourceLine" id="cb292-12" title="12"><span class="kw">contour</span>(muGrid, sigmaGrid, mcApprox, </a>
<a class="sourceLine" id="cb292-13" title="13">        <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;sigma&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;mc without crn&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-289"></span>
<img src="r_and_python_book_files/figure-html/unnamed-chunk-289-1.png" alt="Monte Carlo Approximations versus Exact Evaluations" width="80%" />
<p class="caption">
Figure 15.2: Monte Carlo Approximations versus Exact Evaluations
</p>
</div>
<p>There are three problems with this implementation:</p>
<ul>
<li><code>monteCarloSin()</code> is not pure because it captures the <code>n</code> variable,</li>
<li>the only way to increase the accuracy of the plot in the right panel is to increase <code>n</code>, and</li>
<li>every time we re-run this code the plot on the right looks different.</li>
</ul>
<p>If we wanted to use common random numbers, we could generate <span class="math inline">\(Z^1, \ldots, Z^n \overset{\text{iid}}{\sim} \text{Normal}(0, 1)\)</span>, and use the fact that</p>
<p><span class="math display">\[\begin{equation} 
X^i = \mu + \sigma Z^i
\end{equation}\]</span></p>
<p>This leads to the Monte Carlo estimate</p>
<p><span class="math display">\[\begin{equation} 
\tilde{\mathbb{E}}[\sin(X)] = \frac{1}{n}\sum_{i=1}^n\sin(\mu + \sigma Z^i)
\end{equation}\]</span></p>
<p>Here is one function that naively implements Monte Carlo with common random numbers. We generate the collection of standard normal random variables once, globally. Each time you call <code>monteCarloSinCRNv1(c(10,1))</code>, you get the same answer.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1">commonZs &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span>n)</a>
<a class="sourceLine" id="cb293-2" title="2">monteCarloSinCRNv1 &lt;-<span class="st"> </span><span class="cf">function</span>(params){</a>
<a class="sourceLine" id="cb293-3" title="3">  <span class="kw">stopifnot</span>(params[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb293-4" title="4">  <span class="kw">mean</span>(<span class="kw">sin</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>]<span class="op">*</span>commonZs))</a>
<a class="sourceLine" id="cb293-5" title="5">} </a>
<a class="sourceLine" id="cb293-6" title="6"><span class="co"># monteCarloSinCRNv1(c(10,1))</span></a></code></pre></div>
<p>Let’s compare using common random numbers to going without. As you can see, common random numbers make the plot look “smoother.” In other words, we increase our sampling accuracy without spending more computational time.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">mcApproxCRNv1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(muSigmaGrid, <span class="dv">1</span>, monteCarloSinCRNv1), </a>
<a class="sourceLine" id="cb294-2" title="2">                        <span class="dt">ncol =</span> <span class="kw">length</span>(muGrid))</a>
<a class="sourceLine" id="cb294-3" title="3"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb294-4" title="4"><span class="kw">contour</span>(muGrid, sigmaGrid, mcApprox, </a>
<a class="sourceLine" id="cb294-5" title="5">        <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;sigma&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;mc without crn&quot;</span>)</a>
<a class="sourceLine" id="cb294-6" title="6"><span class="kw">contour</span>(muGrid, sigmaGrid, mcApproxCRNv1, </a>
<a class="sourceLine" id="cb294-7" title="7">        <span class="dt">xlab =</span> <span class="st">&quot;mu&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;sigma&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;mc with crn&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-292"></span>
<img src="r_and_python_book_files/figure-html/unnamed-chunk-292-1.png" alt="Monte Carlo: With and Without Common Random Numbers" width="80%" />
<p class="caption">
Figure 15.3: Monte Carlo: With and Without Common Random Numbers
</p>
</div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>There are some new downsides to this implementation to consider:</p>
<ul>
<li>we have another global variable–a bunch of samples called <code>commonZs</code> floating around, and</li>
<li>the dependence on the global variable for sample size is even further obscured.</li>
</ul>
<p>We can fix these two problems very nicely by using a function factory.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">makeMCFunc &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb296-2" title="2">  commonZs &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb296-3" title="3">  <span class="cf">function</span>(params){</a>
<a class="sourceLine" id="cb296-4" title="4">    <span class="kw">stopifnot</span>(params[<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) </a>
<a class="sourceLine" id="cb296-5" title="5">    <span class="kw">mean</span>(<span class="kw">sin</span>(params[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>params[<span class="dv">2</span>]<span class="op">*</span>commonZs))    </a>
<a class="sourceLine" id="cb296-6" title="6">  }  </a>
<a class="sourceLine" id="cb296-7" title="7">}</a>
<a class="sourceLine" id="cb296-8" title="8">monteCarloSinCRNv2 &lt;-<span class="st"> </span><span class="kw">makeMCFunc</span>()</a>
<a class="sourceLine" id="cb296-9" title="9"><span class="co"># now call monteCarloSinCRNv2 to approx. expectations</span></a>
<a class="sourceLine" id="cb296-10" title="10"><span class="co"># e.g. monteCarloSinCRNv2(c(10,1))</span></a></code></pre></div>
<p>This is much better because</p>
<ul>
<li>the desired sample size must be passed in as a function argument instead of being captured,</li>
<li>the re-used standard normal variates are not in the global environment anymore, and</li>
<li>a sensible default number of samples is provided in the event that the programmer forgets to specify one.</li>
</ul>
<p>The inner function did in fact capture <code>commonZs</code>, but it captured from the enclosing scope, not the global scope. Capturing isn’t always a terrible idea. It would be difficult to modify these variables, so we don’t need to worry about function behavior changing in unpredictable ways. Actually capturing a variable instead of passing it in is an intelligent design choice–now the end-users of functions created by this factory don’t need to worry about plugging in extra parameters.</p>
<p>Let’s use <span class="math inline">\(1000\)</span> samples again and make sure this function works by comparing its output to the known true function. Run the following code on your own machine. Note the new Greek letters in the axis labels.</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1">mcApproxCRNv2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(muSigmaGrid, <span class="dv">1</span>, monteCarloSinCRNv2), </a>
<a class="sourceLine" id="cb297-2" title="2">                        <span class="dt">ncol =</span> <span class="kw">length</span>(muGrid))</a>
<a class="sourceLine" id="cb297-3" title="3"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb297-4" title="4"><span class="kw">contour</span>(muGrid, sigmaGrid, mcApprox, </a>
<a class="sourceLine" id="cb297-5" title="5">        <span class="dt">xlab =</span> <span class="kw">expression</span>(mu), <span class="dt">ylab =</span> <span class="kw">expression</span>(sigma))</a>
<a class="sourceLine" id="cb297-6" title="6"><span class="kw">contour</span>(muGrid, sigmaGrid, mcApproxCRNv2, </a>
<a class="sourceLine" id="cb297-7" title="7">        <span class="dt">xlab =</span> <span class="kw">expression</span>(mu), <span class="dt">ylab =</span> <span class="kw">expression</span>(sigma))</a>
<a class="sourceLine" id="cb297-8" title="8"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
</div>
<div id="functions-as-function-outputs-in-python" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.4</span> Functions as Function Outputs in Python<a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-python" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can write function factories in Python, too. Here is another implementation of the first example from the previous section. Again, just as it did in R, <code>str</code> passed in as <code>greeting_message</code> persists well after <code>func_factory()</code> is finished working.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb298-1" title="1"><span class="kw">def</span> func_factory(greeting_message):</a>
<a class="sourceLine" id="cb298-2" title="2">    <span class="kw">def</span> func(name):</a>
<a class="sourceLine" id="cb298-3" title="3">        <span class="bu">print</span>(greeting_message <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> name)</a>
<a class="sourceLine" id="cb298-4" title="4">    <span class="cf">return</span> func</a>
<a class="sourceLine" id="cb298-5" title="5">greet_with_hello <span class="op">=</span> func_factory(<span class="st">&quot;Hello&quot;</span>)</a>
<a class="sourceLine" id="cb298-6" title="6">greet_with_hello(<span class="st">&quot;Taylor&quot;</span>)</a>
<a class="sourceLine" id="cb298-7" title="7"><span class="co">## Hello Taylor</span></a>
<a class="sourceLine" id="cb298-8" title="8">greet_with_hello(<span class="st">&quot;Charlie&quot;</span>)</a>
<a class="sourceLine" id="cb298-9" title="9"><span class="co">## Hello Charlie</span></a></code></pre></div>
<p>Let’s consider another less trivial example. Recall the spline function from earlier in the chapter:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb299-1" title="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb299-2" title="2"><span class="kw">def</span> spline(x):</a>
<a class="sourceLine" id="cb299-3" title="3">    knot <span class="op">=</span> <span class="fl">3.0</span></a>
<a class="sourceLine" id="cb299-4" title="4">    <span class="cf">if</span> x <span class="op">&gt;=</span> knot:</a>
<a class="sourceLine" id="cb299-5" title="5">        <span class="cf">return</span> x<span class="op">-</span>knot</a>
<a class="sourceLine" id="cb299-6" title="6">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb299-7" title="7">        <span class="cf">return</span> <span class="fl">0.0</span></a></code></pre></div>
<p>This function is limited in that it takes in only one element at a time. Unfortunately, we would not be able to provide an entire Numpy array as an argument (e.g. <code>spline(np.arange(3))</code>). Many functions do possess this behavior, and it is generally advantageous to take advantage of it. If you recall our discussion about universal functions in section <a href="r-vectors-versus-numpy-arrays-and-pandas-series.html#vectorization-in-python">3.4</a>, you might have grown accustomed to taking advantage of writing vectorized code.</p>
<p>Fortunately there’s a way to automatically vectorize functions like the one above: <a href="https://numpy.org/doc/stable/reference/generated/numpy.vectorize.html#numpy.vectorize"><code>np.vectorize()</code></a>. <code>np.vectorize()</code> takes in a unary function, and outputs a vectorized version of it that is able to take entire arrays as an input. Here’s an example. Compare this to us using <code>map()</code> before.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb300-1" title="1">my_inputs <span class="op">=</span> np.linspace(start <span class="op">=</span> <span class="dv">0</span>, stop <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>np.pi)</a>
<a class="sourceLine" id="cb300-2" title="2"><span class="co"># make a vectorized function</span></a>
<a class="sourceLine" id="cb300-3" title="3">vec_spline <span class="op">=</span> np.vectorize(spline) </a>
<a class="sourceLine" id="cb300-4" title="4">vec_spline(my_inputs)[:<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb300-5" title="5"><span class="co"># alternatively output = list(map(spline, my_inputs)) from last time</span></a>
<a class="sourceLine" id="cb300-6" title="6"><span class="co">## array([0., 0., 0., 0.])</span></a></code></pre></div>
<p>The above code doesn’t just demonstrate how to return functions from a function. It is also an example of using functions as function inputs. When a function takes in and spits out functions, there is an alternative way to use it that is unique to Python. You can use <strong><a href="https://www.python.org/dev/peps/pep-0318/">function decorators</a>.</strong> You can <em>decorate</em> a function by using the <code>@</code> operator <span class="citation">(Lutz <a href="#ref-Lutz13">2013</a>)</span>.</p>
<p>If you decorate a function, it is equivalent to passing that function in to a function factory (aka outer function). That function will take the function you defined, alter it, and then give it back to you with the same name that you chose in the first place.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb301-1" title="1"><span class="co"># instead of spline = np.vectorize(spline) </span></a>
<a class="sourceLine" id="cb301-2" title="2"><span class="at">@np.vectorize</span></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="kw">def</span> spline(x):</a>
<a class="sourceLine" id="cb301-4" title="4">    knot <span class="op">=</span> <span class="fl">3.0</span></a>
<a class="sourceLine" id="cb301-5" title="5">    <span class="cf">if</span> x <span class="op">&gt;=</span> knot:</a>
<a class="sourceLine" id="cb301-6" title="6">        <span class="cf">return</span> x<span class="op">-</span>knot</a>
<a class="sourceLine" id="cb301-7" title="7">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb301-8" title="8">        <span class="cf">return</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb301-9" title="9">spline(my_inputs)[:<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb301-10" title="10"><span class="co">## array([0., 0., 0., 0.])</span></a></code></pre></div>
<div id="writing-our-own-decorators" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.4.1</span> Writing Our Own Decorators<a href="an-introduction-to-functional-programming.html#writing-our-own-decorators" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can write our own function factory that can be used as decoration. The main restriction is that this function factory must take a function as an argument, too. This can sometimes be restrictive. You might have noticed that the definition of <code>func_factory()</code> from earlier in this section did not do that. If you don’t believe me, as an exercise, after you read this section, you might consider trying to rewrite the example from <a href="an-introduction-to-functional-programming.html#functions-as-function-outputs-in-r">15.3</a> that implements Monte Carlo sampling using common random numbers.</p>
<p>Before we get too ahead of ourselves, let’s describe the basics. Here is our first decorator function <code>add_greeting()</code>.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb302-1" title="1"><span class="kw">def</span> add_greeting(func):</a>
<a class="sourceLine" id="cb302-2" title="2">    <span class="kw">def</span> wrapper(name):</a>
<a class="sourceLine" id="cb302-3" title="3">        <span class="bu">print</span>(<span class="st">&#39;Salutations, &#39;</span>)</a>
<a class="sourceLine" id="cb302-4" title="4">        func(name)</a>
<a class="sourceLine" id="cb302-5" title="5">    <span class="cf">return</span> wrapper</a></code></pre></div>
<p>The decorator <code>add_greeting()</code> returns a function that is an embellished version of the function it is given. When we decorate a function with it, it looks like this.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb303-1" title="1"><span class="at">@add_greeting</span></a>
<a class="sourceLine" id="cb303-2" title="2"><span class="kw">def</span> print_name(first_name):</a>
<a class="sourceLine" id="cb303-3" title="3">    <span class="bu">print</span>(first_name)</a></code></pre></div>
<p>You could get the same behavior by typing the following. They are equivalent!</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb304-1" title="1"><span class="kw">def</span> print_name(first_name):</a>
<a class="sourceLine" id="cb304-2" title="2">    <span class="bu">print</span>(first_name)</a>
<a class="sourceLine" id="cb304-3" title="3">print_name <span class="op">=</span> add_greeting(print_name)</a></code></pre></div>
<p>Things can get a little more complicated when your decorators take additional arguments.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb305-1" title="1"><span class="at">@add_greeting</span>(<span class="st">&quot;How you doin&#39;&quot;</span>)</a>
<a class="sourceLine" id="cb305-2" title="2"><span class="kw">def</span> print_name(first_name):</a>
<a class="sourceLine" id="cb305-3" title="3">    <span class="bu">print</span>(first_name)</a>
<a class="sourceLine" id="cb305-4" title="4">print_name(<span class="st">&#39;Taylor&#39;</span>)</a>
<a class="sourceLine" id="cb305-5" title="5"><span class="co">## How you doin&#39;</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="co">## Taylor</span></a></code></pre></div>
<p>So how do we write decorators that accomplish this? The important thing to remember is that <code>@add_greeting("How you doin'")</code> in the previous code block is equivalent to writing this after the function definition: <code>print_name = add_greeting("How you doin'")(print_name)</code>. This is a function returning a function returning a function! The definition of <code>add_greeting()</code> could look something like this.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb306-1" title="1"><span class="kw">def</span> add_greeting(greet):</a>
<a class="sourceLine" id="cb306-2" title="2">    <span class="kw">def</span> decorator(func):</a>
<a class="sourceLine" id="cb306-3" title="3">        <span class="kw">def</span> wrapper(name):</a>
<a class="sourceLine" id="cb306-4" title="4">            <span class="bu">print</span>(greet)</a>
<a class="sourceLine" id="cb306-5" title="5">            func(name)</a>
<a class="sourceLine" id="cb306-6" title="6">        <span class="cf">return</span> wrapper</a>
<a class="sourceLine" id="cb306-7" title="7">    <span class="cf">return</span> decorator</a></code></pre></div>
<p>Now that you know how decorators work, you can feel comfortable using third-party ones. You might come across, for example, the <code>@jit</code> decorator from <a href="https://numba.pydata.org/">Numba</a>, which will translate your Python function into faster machine code, the <code>@lru_cache</code> decorator from the <a href="https://docs.python.org/3/library/functools.html"><code>functools</code> module</a>–this can make your code faster by saving some of its outputs–or decorators that perform application specific tasks like <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code>@tf.function</code></a> from Tensorflow.</p>
</div>
</div>
<div id="exercises-13" class="section level2 hasAnchor">
<h2><span class="header-section-number">15.5</span> Exercises<a href="an-introduction-to-functional-programming.html#exercises-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="python-questions-12" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.5.1</span> Python Questions<a href="an-introduction-to-functional-programming.html#python-questions-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>Write a function decorator called <code>@log_dens_eval(left_bound, right_bound)</code>. When it decorates a function, say <code>func(x)</code>, it will not change that function’s input or output, but it will verify that the input to the function (in this case <code>x</code>) is between <code>left_bound</code> and <code>right_bound</code>. If it is not, it will return negative infinity.</p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>The Split-Apply-Combine strategy might be useful in writing code for a tree-based model <span class="citation">(Breiman et al. <a href="#ref-trees">1984</a>)</span>. We won’t discuss how these models are estimated, but we will write a function that generates another function that is able to generate predictions by stratifying the input/predictor/feature space.</p>
<ol style="list-style-type: lower-alpha">
<li>Import the data <code>"winequality-red.csv"</code>, call it <code>wine</code>, and remove all columns except for <code>fixed acidity</code>, <code>volatile acidity</code>, and <code>quality</code>.</li>
<li>Write a function called <code>generate_pred_func(fixed_cutoff, vol_cutoff, dataset)</code>.
<ul>
<li>The <code>dataset</code> argument should be a Pandas <code>DataFrame</code> that has three columns called <code>fixed acidity</code>, <code>volatile acidity</code>, and <code>quality</code>.</li>
<li>The <code>fixed_cutoff</code> argument should be a floating point number that separates <code>fixed acidity</code> into two regions.</li>
<li>The <code>vol_cutoff</code> argument should be a floating point number that separates <code>volatile acidity</code> into two regions.</li>
<li>The function should return a function, say <code>func(fixed_acidity, volatile_acidity)</code>. The two arguments are floating points. This function should return the most frequent <code>quality</code> observation out of all points whose inputs lie in in the corresponding region in the feature space.</li>
</ul></li>
</ol>
<p>After you finish the problem, you should have a definition of a <code>generate_pred_func()</code> that could be used as follows:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb307-1" title="1">predict <span class="op">=</span> generate_pred_func(fixed_cutoff<span class="op">=</span><span class="dv">8</span>, vol_cutoff<span class="op">=</span>.<span class="dv">5</span>, dataset<span class="op">=</span>wine)</a>
<a class="sourceLine" id="cb307-2" title="2">predict(<span class="dv">10</span>,<span class="dv">10</span>)</a></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Let’s predict what type of activity some is doing based on measurements taken from their cell phone. We will begin implementing a <strong>K-Nearest Neighbors (KNN) classifier</strong> <span class="citation">(Fix and Hodges <a href="#ref-knn1">1989</a>)</span> <span class="citation">(Cover and Hart <a href="#ref-knn2">1967</a>)</span>.</p>
<p>Consider the data files <code>"X_train.txt"</code> and <code>"y_train.txt"</code> from <span class="citation">(Anguita et al. <a href="#ref-Anguita2013APD">2013</a>)</span>, which is available from the UCI Machine Learning Repository <span class="citation">(Dua and Graff <a href="#ref-uci_data">2017</a>)</span>. The first data set consists of recorded movements from a cell phone, and the second data set consists of activity labels of people. Labels <span class="math inline">\(1\)</span> through <span class="math inline">\(6\)</span> correspond to walking, walking upstairs, walking downstairs, sitting, standing and laying, respectively.</p>
<ol style="list-style-type: lower-alpha">
<li>Read in <code>"X_train.txt"</code> as a <code>DataFrame</code> called <code>x_train</code>.</li>
<li>Read in <code>"y_train.txt"</code> as a <code>DataFrame</code> called <code>y_train</code></li>
<li>Define a function called <code>standardize(arr)</code> that takes in an array-like and returns a standardized version of the array-like. Do this by subtracting from each element the overall mean and dividing each element by the standard deviation (use the length as a denominator, not length minus <span class="math inline">\(1\)</span>).</li>
<li>Apply <code>standardize()</code> to each column and transform <code>x_train</code> by replacing all of its column by their standardized versions. Make sure to overwrite <code>x_train</code>. Do this in one line of code.</li>
<li>Write a function called <code>euclid_dist(arr1, arr2)</code> that calculates Euclidean distance between two points/array-likes.</li>
<li>What is the most common label among the 5 rows that are closest to the first row? Assign your answer to <code>my_predict</code>. Assume that the two data sets you imported have the same order. Don’t include the first row in these <span class="math inline">\(5\)</span> <em>nearest neighbors</em>. Take care not to modify <code>x_train</code> or <code>y_train</code>.</li>
</ol>
</div>
<div id="r-questions-12" class="section level3 hasAnchor">
<h3><span class="header-section-number">15.5.2</span> R Questions<a href="an-introduction-to-functional-programming.html#r-questions-12" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li></li>
</ol>
<p>The density of a particular bivariate Gaussian distribution is</p>
<p><span class="math display">\[
f(x,y) = \frac{1}{2 \pi}  \exp\left[ -\frac{x ^2 + y^2}{2}     \right] \tag{1}.
\]</span>
The random elements <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, in this particular case, are independent, each have unit variance, and zero mean. In this case, the marginal for <span class="math inline">\(X\)</span> is a mean <span class="math inline">\(0\)</span>, unit variance normal distribution:</p>
<p><span class="math display">\[
g(x) = \frac{1}{\sqrt{2\pi}} \exp\left[ -\frac{x ^2 }{2}     \right] \tag{2}.
\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Write a function called <code>fTwoArgs(x,y)</code> that takes two arguments, and returns the value of the above density in equation (1) at those two points.</li>
<li>Write a function called <code>fOneArg(vec)</code> that takes one argument: a length two <code>vector</code>. It should return a density in equation (1) evaluated at that point.</li>
<li>Write a function called <code>gOneArg(x)</code> that evaluates the density in (2).</li>
<li>Generate two sequences called <code>xPoints</code> and <code>yPoints</code>. Have them contain the twenty equally-spaced numbers going from <span class="math inline">\(-3\)</span> to <span class="math inline">\(3\)</span>, inclusive.</li>
<li>Use <code>expand.grid()</code> to create a <code>data.frame</code> called <code>myGrid</code>. It should have two columns, and it should contain in its rows every possible pair of two points from the above sequences. The “x” coordinates should be in the first column.</li>
<li>Use <code>mapply()</code> to evaluate the bivariate density on every grid point. Store your results in a <code>vector</code> <code>mEvals</code>.</li>
<li>Use <code>apply()</code> to evaluate the bivariate density on every grid point. Store your results in a <code>vector</code> <code>aEvals</code>.</li>
<li>Use <code>sapply()</code> to evaluate the univariate density on every element of <code>xPoints</code>. Store your results in a <code>vector</code> <code>sEvals</code>.</li>
<li>Use <code>vapply</code> to evaluate the univariate density on every element of <code>xPoints</code>. Store your results in <code>vector</code> <code>vEvals</code>.</li>
<li>Use <code>lapply</code> to evaluate the univariate density on every element of <code>xPoints</code>. Store your results in a <code>list</code> <code>lEvals</code>.</li>
<li>Generate two plots of the bivariate density. For one, use <code>persp()</code>. For the other, use <code>contour()</code>. Feel free to revive the code you used in Chapter 13’s Exercise 1.</li>
<li>Generate a third plot of the univariate density. Feel free to revive the code you used in Chapter 13’s Exercises.</li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<p>Write a function that reads in all of the data sets contained in any given folder.</p>
<ul>
<li>The function should be called <code>readAllData(path, extensions)</code>.</li>
<li>The first argument, <code>path</code>, should be a string representing which folder you would like to search for files.</li>
<li>The second argument, <code>extensions</code>, should be a <code>character</code> <code>vector</code> of all the file extensions you are interested in reading in (e.g. <code>c('.txt','.csv')</code>). Be careful about using regular expressions!</li>
<li>The function should return a <code>list</code> of <code>data.frame</code>s.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li></li>
</ol>
<p>Consider the Militarized Interstate Disputes (v5.0) <span class="citation">(Palmer et al.<a href="#ref-mid5"></a>)</span> data sets again: <code>"MIDA 5.0.csv"</code>, <code>"MIDB 5.0.csv"</code>, <code>"MIDI 5.0.csv"</code>, and <code>"MIDIP 5.0.csv"</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>Read these data sets in as a <code>list</code> of <code>data.frame</code>s. Call it <code>dfList</code>.</li>
<li>Use <code>lapply()</code> and <code>do.call()</code> to calculate the biggest column average for all of these data sets. Store this average as <code>biggestAve</code>. Store the name of the column that had this biggest average as <code>whichBiggestAve</code>. Don’t worry about storing which data set this column mean was found in.</li>
<li>Use <code>Reduce()</code> and <code>lapply()</code> to, once again, calculate the biggest column average. Store this number as <code>biggestAve2</code></li>
</ol>
<!-- ### Exercises -->
<!-- 1.  Let $X_t$ be the price of a stock at time $t$. A *call (or put) option* is a type of derivative contract you can buy or sell. It's called a derivative because its value derives from the value of a stock. A single call contract (or put) gives the owner the right to buy (or sell) stock ($100$ shares) at a certain price. This certain price written into an options contract ($s$) is called the *strike price*. The day the option expires    is called the *expiration date*. If a holder of the option uses his/her right to buy or sell the underlying stock, he/she is said to have *exercised* the option. -->
<!-- The price and value of options floats around randomly through time just like a stock does. Part of the value of an option is its *intrinsic value*. It is not the same as the overall value of an option, or its "fair price"--rather, the intrinsic value represents how much money its possible to guarantee at the current moment, if you exercised the option, and then liquidated the resulting position in the underlying. -->
<!-- For example, call owners hope the stock rises above the strike price so that they can buy the stock for a low price, and immediately sell it for a high price. If $X_t > s$, they could buy at $s$, and sell at $X_t$. In other words, the intrinsic value of a call option is  -->
<!-- $$ -->
<!-- C^s_t = 100 \times \max(X_t - s, 0) -->
<!-- $$ -->
<!-- as long as $t$ is before the expiration date. If $X_t < s$, then the owner doesn't have to buy the stock, so the call at that time is intrinsically worthless.  -->
<!-- Put owners hope the stock price falls below the strike price, because a put's intrinsic value is -->
<!-- $$ -->
<!-- P^s_t = 100 \times \max(s - X_t, 0) -->
<!-- $$ -->
<!-- Sometimes people buy and sell multiple contracts (with the same expiration date) at the same time. If they do, the intrinsic value of the entire position is additive. For example, if you bought two of the same put option as the one above, then you just double the above expression to get the intrinsic value. -->
<!-- As another example, if you buy (you can also sell) a *call spread*, you buy one call, and then sell another call with the same expiration and a higher strike price. Assuming $s_1 < s_2$ the intrinsic value is of the call spread with strikes $s_1$ and $s_2$ is -->
<!-- $$ -->
<!-- 100 \times \max(X_t - s_1, 0) - 100\times\max(X_t - s_2, 0) -->
<!-- $$ -->
<!-- a. In R, write a function called `getIntrinsicValueFunc` that takes three vectors as arguments, (`dirs`, `strikes`, `contractType`, `numContracts`), and returns a function. These arguments should all be the same length. The length of these inputs is the number of contracts in an options position. The function that `getIntrinsicValueFunc` returns should only take one argument: `prices`, a vector of prices of the underlying stock. The function that `getIntrinsicValueFunc` should return a vector of intrinsic values over time.  -->
<!-- Because the arguments may only take on certain values, and because the function to be returned has a certain signature, a template has been provided below.  -->
<!-- ```{r, eval=F} -->
<!-- getIntrinsicValueFunc <-function(dirs, strikes, contractType, numContracts){ -->
<!--   stopifnot(all(dirs %in% c("buy", "sell"))) -->
<!--   stopifnot(all(contractType %in% c("call", "put"))) -->
<!--   stopifnot(all(is.integer(strikes))) -->
<!--   stopifnot(all(is.integer(numContracts))) -->
<!--   stopifnot( (length(dirs) == length(strikes)) && (length(dirs) == length(contractType))) -->
<!--   usefulFunc <- function(prices){ -->
<!--     # TODO -->
<!--   } -->
<!--   return(usefulFunc) -->
<!-- }  -->
<!-- ``` -->
<!-- b. Create an intrinsic value plot. The x-axis should be a grid of values: let's say from $100$ to $200$. On the y-axis plot the intrinsic value of buying a call spread with strikes $110$ and $120$.  -->
<!-- c. Do the same thing as above but show what happens when you sell the same call spread.  -->
<!-- d. Plot the intrinsic value of a bought put spread with strikes $110$ and $120$.  -->
<!-- e. Plot the intrinsic value of a sold put spread with strikes $110$ and $120$. What is the difference between all four plots? -->
<!-- 2. Do the same thing, but in Python! -->
<!-- creating row masks in a data frame -->
<!-- .apply with weird predicate function -->
<!-- Optimization example  -->
<!-- Importance sampling example -->
<!-- bootstrap -->
<!-- numerical integration -->
<!-- 3. verbal, open-ended wuestion about what happens when you make a typo in a variable name? R versus Python? -->
<!-- 4. try to think of the most complicated program that uses two functions that both use (and modify) globals -->

<div id="refs" class="references">
<div>
<p>Abelson, Harold, and Gerald J. Sussman. 1996. <em>Structure and Interpretation of Computer Programs</em>. 2nd ed. Cambridge, MA, USA: MIT Press.</p>
</div>
<div>
<p>“Adult.” 1996. UCI Machine Learning Repository.</p>
</div>
<div>
<p>Albemarle County Geographic Data Services Office. 2021. “Albemarle County GIS Web.” <a href="https://www.albemarle.org/government/community-development/gis-mapping/gis-data">https://www.albemarle.org/government/community-development/gis-mapping/gis-data</a>.</p>
</div>
<div>
<p>Albon, Chris. 2018. <em>Machine Learning with Python Cookbook: Practical Solutions from Preprocessing to Deep Learning</em>. 1st ed. O’Reilly Media, Inc.</p>
</div>
<div>
<p>Anguita, D., Alessandro Ghio, L. Oneto, Xavier Parra, and Jorge Luis Reyes-Ortiz. 2013. “A Public Domain Dataset for Human Activity Recognition Using Smartphones.” In <em>ESANN</em>.</p>
</div>
<div>
<p>Beazley, David M., and Brian K. (Brian Kenneth) Jones. 2014. <em>Python Cookbook: Recipes for Mastering Python 3</em>. Third. pub-ora-media:adr: pub-ora-media.</p>
</div>
<div>
<p>Breiman, L., J. H. Friedman, R. A. Olshen, and C. J. Stone. 1984. <em>Classification and Regression Trees</em>. Monterey, CA: Wadsworth; Brooks.</p>
</div>
<div>
<p>Brown, Taylor. 2021. <em>CPseudoMaRg: Constructs a Correlated Pseudo-Marginal Sampler</em>. <a href="https://CRAN.R-project.org/package=cPseudoMaRg">https://CRAN.R-project.org/package=cPseudoMaRg</a>.</p>
</div>
<div>
<p>“Car Evaluation.” 1997. UCI Machine Learning Repository.</p>
</div>
<div>
<p>Carvalho, Carlos M., Nicholas G. Polson, and James G. Scott. 2009. “Handling Sparsity via the Horseshoe.” In <em>Proceedings of the Twelth International Conference on Artificial Intelligence and Statistics</em>, edited by David van Dyk and Max Welling, 5:73–80. Proceedings of Machine Learning Research. Hilton Clearwater Beach Resort, Clearwater Beach, Florida USA: PMLR. <a href="https://proceedings.mlr.press/v5/carvalho09a.html">https://proceedings.mlr.press/v5/carvalho09a.html</a>.</p>
</div>
<div>
<p>Chang, Winston. 2013. <em>R Graphics Cookbook</em>. O’Reilly Media, Inc.</p>
</div>
<div>
<p>“Chess (King-Rook vs. King-Pawn).” 1989. UCI Machine Learning Repository.</p>
</div>
<div>
<p>Cortez, Paulo, António Cerdeira, Fernando Almeida, Telmo Matos, and José Reis. 2009. “Modeling Wine Preferences by Data Mining from Physicochemical Properties.” <em>Decis. Support Syst.</em> 47 (4): 547–53. <a href="http://dblp.uni-trier.de/db/journals/dss/dss47.html#CortezCAMR09">http://dblp.uni-trier.de/db/journals/dss/dss47.html#CortezCAMR09</a>.</p>
</div>
<div>
<p>Cover, T., and P. Hart. 1967. “Nearest Neighbor Pattern Classification.” <em>IEEE Transactions on Information Theory</em> 13 (1): 21–27. <a href="https://doi.org/10.1109/TIT.1967.1053964">https://doi.org/10.1109/TIT.1967.1053964</a>.</p>
</div>
<div>
<p>Dua, Dheeru, and Casey Graff. 2017. “UCI Machine Learning Repository.” University of California, Irvine, School of Information; Computer Sciences. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.</p>
</div>
<div>
<p>Efron, B. 1979. “Bootstrap Methods: Another Look at the Jackknife.” <em>The Annals of Statistics</em> 7 (1): 1–26. <a href="https://doi.org/10.1214/aos/1176344552">https://doi.org/10.1214/aos/1176344552</a>.</p>
</div>
<div>
<p>Fisher, Test, R.A. &amp; Creator. 1988. “Iris.” UCI Machine Learning Repository.</p>
</div>
<div>
<p>Fix, Evelyn, and J. L. Hodges. 1989. “Discriminatory Analysis. Nonparametric Discrimination: Consistency Properties.” <em>International Statistical Review / Revue Internationale de Statistique</em> 57 (3): 238–47. <a href="http://www.jstor.org/stable/1403797">http://www.jstor.org/stable/1403797</a>.</p>
</div>
<div>
<p>Ford, Clay. 2016. “ggplot: Files for UVA StatLab workshop, Fall 2016.” <em>GitHub Repository</em>. <a href="https://github.com/clayford/ggplot2">https://github.com/clayford/ggplot2</a>; GitHub.</p>
</div>
<div>
<p>Gelman, Andrew, and Jennifer Hill. 2007. <em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>. Analytical Methods for Social Research. Cambridge University Press.</p>
</div>
<div>
<p>Grolemund, G. 2014. <em>Hands-on Programming with R: Write Your Own Functions and Simulations</em>. O’Reilly Media. <a href="https://books.google.com/books?id=S04BBAAAQBAJ">https://books.google.com/books?id=S04BBAAAQBAJ</a>.</p>
</div>
<div>
<p>“GSPC Data.” 2021. <a href="https://finance.yahoo.com/quote/%5EGSPC/history?p=%5EGSPC">https://finance.yahoo.com/quote/%5EGSPC/history?p=%5EGSPC</a>.</p>
</div>
<div>
<p>Guttman, Louis. 1946. “Enlargement Methods for Computing the Inverse Matrix.” <em>The Annals of Mathematical Statistics</em> 17 (3): 336–43. <a href="https://doi.org/10.1214/aoms/1177730946">https://doi.org/10.1214/aoms/1177730946</a>.</p>
</div>
<div>
<p>Harrell Jr, Frank E, with contributions from Charles Dupont, and many others. 2021. <em>Hmisc: Harrell Miscellaneous</em>. <a href="https://CRAN.R-project.org/package=Hmisc">https://CRAN.R-project.org/package=Hmisc</a>.</p>
</div>
<div>
<p>Harris, Charles R., K. Jarrod Millman, Stéfan J. van der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, et al. 2020. “Array Programming with NumPy.” <em>Nature</em> 585 (7825): 357–62. <a href="https://doi.org/10.1038/s41586-020-2649-2">https://doi.org/10.1038/s41586-020-2649-2</a>.</p>
</div>
<div>
<p>Hunt, Andrew, and David Thomas. 2000. <em>The Pragmatic Programmer : From Journeyman to Master</em>. Boston [etc.]: Addison-Wesley. <a href="http://www.amazon.com/The-Pragmatic-Programmer-Journeyman-Master/dp/020161622X">http://www.amazon.com/The-Pragmatic-Programmer-Journeyman-Master/dp/020161622X</a>.</p>
</div>
<div>
<p>Hunter, J. D. 2007. “Matplotlib: A 2D Graphics Environment.” <em>Computing in Science &amp; Engineering</em> 9 (3): 90–95. <a href="https://doi.org/10.1109/MCSE.2007.55">https://doi.org/10.1109/MCSE.2007.55</a>.</p>
</div>
<div>
<p>Janosi, Andras, William Steinbrunn, Matthias Pfisterer, and Robert Detrano. 1988. “Heart Disease.” UCI Machine Learning Repository.</p>
</div>
<div>
<p>Jones, Karen Spärck. 1972. “A Statistical Interpretation of Term Specificity and Its Application in Retrieval.” <em>Journal of Documentation</em> 28: 11–21.</p>
</div>
<div>
<p>Kabacoff, Robert I. 2015. <em>R in Action</em>. Second. Manning. <a href="http://www.worldcat.org/isbn/9781617291388">http://www.worldcat.org/isbn/9781617291388</a>.</p>
</div>
<div>
<p>Kahn, H. 1950. “Random Sampling (Monte Carlo) Techniques in Neutron Attenuation Problems–I.” <em>Nucleonics</em> 6 5.</p>
</div>
<div>
<p>Kahn, H. 1950. “Random Sampling (Monte Carlo) Techniques in Neutron Attenuation Problems. II.” <em>Nucleonics (U.S.) Ceased Publication</em> Vol: 6, No. 6 (June). <a href="https://www.osti.gov/biblio/4399718">https://www.osti.gov/biblio/4399718</a>.</p>
</div>
<div>
<p>Kalman, R. E. 1960. “A New Approach to Linear Filtering and Prediction Problems.” <em>Journal of Basic Engineering</em> 82 (1): 35–45. <a href="https://doi.org/10.1115/1.3662552">https://doi.org/10.1115/1.3662552</a>.</p>
</div>
<div>
<p>Lander, Jared P. 2017. <em>R for Everyone: Advanced Analytics and Graphics (2nd Edition)</em>. 2nd ed. Addison-Wesley Professional.</p>
</div>
<div>
<p>López, Félix. 2014. <em>Mastering Python Regular Expressions : Leverage Regular Expressions in Python Even for the Most Complex Features</em>. Birmingham, UK: Packt Pub.</p>
</div>
<div>
<p>Lutz, Mark. 2013. <em>Learning Python</em>. 5th ed. Beijing: O’Reilly. <a href="https://www.safaribooksonline.com/library/view/learning-python-5th/9781449355722/">https://www.safaribooksonline.com/library/view/learning-python-5th/9781449355722/</a>.</p>
</div>
<div>
<p>Matloff, Norman. 2011. <em>The Art of R Programming: A Tour of Statistical Software Design</em>. 1st ed. USA: No Starch Press.</p>
</div>
<div>
<p>McKinney, Wes. 2017. <em>Python for Data Analysis: Data Wrangling with Pandas, Numpy, and Ipython</em>. 2nd ed. O’Reilly Media, Inc.</p>
</div>
<div>
<p>Nadaraya, E. A. 1964. “On Estimating Regression.” <em>Theory of Probability &amp; Its Applications</em> 9 (1): 141–42. <a href="https://doi.org/10.1137/1109020">https://doi.org/10.1137/1109020</a>.</p>
</div>
<div>
<p>Palmer, Glenn, Roseanne W McManus, Vito D’Orazio, Michael R Kenwick, Mikaela Karstens, Chase Bloch, Nick Dietrich, Kayla Kahn, Kellan Ritter, and Michael J Soules“The Mid5 Dataset, 2011–2014: Procedures, Coding Rules, and Description.” <em>Conflict Management and Peace Science</em> 0 (0): 0738894221995743. <a href="https://doi.org/10.1177/0738894221995743">https://doi.org/10.1177/0738894221995743</a>.</p>
</div>
<div>
<p>Robert, Christian P., and George Casella. 2005. <em>Monte Carlo Statistical Methods (Springer Texts in Statistics)</em>. Berlin, Heidelberg: Springer-Verlag.</p>
</div>
<div>
<p>“SAS<sup></sup> Viya<sup></sup> Example Data Sets.” 2021. <a href="https://support.sas.com/documentation/onlinedoc/viya/examples.htm">https://support.sas.com/documentation/onlinedoc/viya/examples.htm</a>.</p>
</div>
<div>
<p>Socher, Richard, Alex Perelygin, Jean Wu, Jason Chuang, Christopher Manning, Andrew Ng, and Christopher Potts. 2013. “Parsing with Compositional Vector Grammars.” In <em>EMNLP</em>.</p>
</div>
<div>
<p>Student. 1908. “The Probable Error of a Mean.” <em>Biometrika</em>, 1–25.</p>
</div>
<div>
<p>“TensorFlow Datasets, a Collection of Ready-to-Use Datasets.” 2021. <a href="https://www.tensorflow.org/datasets">https://www.tensorflow.org/datasets</a>.</p>
</div>
<div>
<p>VanderPlas, Jake. 2016. <em>Python Data Science Handbook: Essential Tools for Working with Data</em>. 1st ed. O’Reilly Media, Inc.</p>
</div>
<div>
<p>Watson, Geoffrey S. 1964. “Smooth Regression Analysis.” <em>Sankhyā: The Indian Journal of Statistics, Series A (1961-2002)</em> 26 (4): 359–72. <a href="http://www.jstor.org/stable/25049340">http://www.jstor.org/stable/25049340</a>.</p>
</div>
<div>
<p>West, Michael A., and Jeff Harrison. 1989. “Bayesian Forecasting and Dynamic Models.” In.</p>
</div>
<div>
<p>Wickham, H. 2014. <em>Advanced R</em>. Chapman &amp; Hall/Crc the R Series. Taylor &amp; Francis. <a href="https://books.google.com/books?id=PFHFNAEACAAJ">https://books.google.com/books?id=PFHFNAEACAAJ</a>.</p>
</div>
<div>
<p>Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.</p>
</div>
<div>
<p>Wickham, Hadley, and Garrett Grolemund. 2017. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. 1st ed. O’Reilly Media, Inc.</p>
</div>
<div>
<p>Wilkinson, Leland. 2005. <em>The Grammar of Graphics (Statistics and Computing)</em>. Berlin, Heidelberg: Springer-Verlag.</p>
</div>
</div>
</div>
</div>
</div>




































<h3>References</h3>
<div id="refs" class="references">
<div id="ref-struc_and_interp">
<p>Abelson, Harold, and Gerald J. Sussman. 1996. <em>Structure and Interpretation of Computer Programs</em>. 2nd ed. Cambridge, MA, USA: MIT Press.</p>
</div>
<div id="ref-albemarle_county_gis_web">
<p>Albemarle County Geographic Data Services Office. 2021. “Albemarle County GIS Web.” <a href="https://www.albemarle.org/government/community-development/gis-mapping/gis-data">https://www.albemarle.org/government/community-development/gis-mapping/gis-data</a>.</p>
</div>
<div id="ref-Anguita2013APD">
<p>Anguita, D., Alessandro Ghio, L. Oneto, Xavier Parra, and Jorge Luis Reyes-Ortiz. 2013. “A Public Domain Dataset for Human Activity Recognition Using Smartphones.” In <em>ESANN</em>.</p>
</div>
<div id="ref-trees">
<p>Breiman, L., J. H. Friedman, R. A. Olshen, and C. J. Stone. 1984. <em>Classification and Regression Trees</em>. Monterey, CA: Wadsworth; Brooks.</p>
</div>
<div id="ref-knn2">
<p>Cover, T., and P. Hart. 1967. “Nearest Neighbor Pattern Classification.” <em>IEEE Transactions on Information Theory</em> 13 (1): 21–27. <a href="https://doi.org/10.1109/TIT.1967.1053964">https://doi.org/10.1109/TIT.1967.1053964</a>.</p>
</div>
<div id="ref-uci_data">
<p>Dua, Dheeru, and Casey Graff. 2017. “UCI Machine Learning Repository.” University of California, Irvine, School of Information; Computer Sciences. <a href="http://archive.ics.uci.edu/ml">http://archive.ics.uci.edu/ml</a>.</p>
</div>
<div id="ref-knn1">
<p>Fix, Evelyn, and J. L. Hodges. 1989. “Discriminatory Analysis. Nonparametric Discrimination: Consistency Properties.” <em>International Statistical Review / Revue Internationale de Statistique</em> 57 (3): 238–47. <a href="http://www.jstor.org/stable/1403797">http://www.jstor.org/stable/1403797</a>.</p>
</div>
<div id="ref-clay_ford">
<p>Ford, Clay. 2016. “ggplot: Files for UVA StatLab workshop, Fall 2016.” <em>GitHub Repository</em>. <a href="https://github.com/clayford/ggplot2">https://github.com/clayford/ggplot2</a>; GitHub.</p>
</div>
<div id="ref-hunt2000pragmatic">
<p>Hunt, Andrew, and David Thomas. 2000. <em>The Pragmatic Programmer : From Journeyman to Master</em>. Boston [etc.]: Addison-Wesley. <a href="http://www.amazon.com/The-Pragmatic-Programmer-Journeyman-Master/dp/020161622X">http://www.amazon.com/The-Pragmatic-Programmer-Journeyman-Master/dp/020161622X</a>.</p>
</div>
<div id="ref-Lutz13">
<p>Lutz, Mark. 2013. <em>Learning Python</em>. 5th ed. Beijing: O’Reilly. <a href="https://www.safaribooksonline.com/library/view/learning-python-5th/9781449355722/">https://www.safaribooksonline.com/library/view/learning-python-5th/9781449355722/</a>.</p>
</div>
<div id="ref-mid5">
<p>Palmer, Glenn, Roseanne W McManus, Vito D’Orazio, Michael R Kenwick, Mikaela Karstens, Chase Bloch, Nick Dietrich, Kayla Kahn, Kellan Ritter, and Michael J Soules“The Mid5 Dataset, 2011–2014: Procedures, Coding Rules, and Description.” <em>Conflict Management and Peace Science</em> 0 (0): 0738894221995743. <a href="https://doi.org/10.1177/0738894221995743">https://doi.org/10.1177/0738894221995743</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="27">
<li id="fn27"><p>Even though this book only discusses <em>one</em> of our languages of interest, this quote applies to both langauges.<a href="an-introduction-to-functional-programming.html#fnref27" class="footnote-back">↩</a></p></li>
<li id="fn28"><p><code>apply()</code> is everyone’s favorite whipping boy whenever it comes to comparing <code>apply()</code> against the other <code>*apply()</code> functions. This is because it is generally a little slower–it is written in R and doesn’t call out to compiled C code. However, in my humble opinion, it doesn’t matter all that much because the fractions of a second saved don’t always add up in practice. <a href="an-introduction-to-functional-programming.html#fnref28" class="footnote-back">↩</a></p></li>
<li id="fn29"><p>Although, it is still variadic. The difference is that the <code>dot-dot-dot</code> symbol does not refer to a varying number of <code>data.frame</code>s, just a varying number of other things we don’t care about in this example.<a href="an-introduction-to-functional-programming.html#fnref29" class="footnote-back">↩</a></p></li>
<li id="fn30"><p>To make it even more flexible, we could write code that doesn’t assume the functions are all named the same way, or in the same directory together.<a href="an-introduction-to-functional-programming.html#fnref30" class="footnote-back">↩</a></p></li>
<li id="fn31"><p>You should know that a lot of special-case functions that you typically apply to rows or columns come built-in as <code>DataFrame</code> methods. For instance, <code>.mean()</code> would allow you to do something like <code>my_df.mean()</code>.<a href="an-introduction-to-functional-programming.html#fnref31" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="an-introduction-to-object-oriented-programming.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tbrown122387/r_and_python_book/edit/master/15-FP.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
